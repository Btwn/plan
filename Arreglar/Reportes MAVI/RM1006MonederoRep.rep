[Reporte]
Clave=RM1006MonederoRep
Nombre=Comparativo Ventas Direccion
Icono=0
VistaEspecial=S
Tipo=Reporte
SubmenuPreliminar=S
ImpresoraEspecifica=(por Omisión)
ImpresoraPixeles=(Auto)
ImpresoraFactor=(Auto)
ImpresoraAlto=(Auto)
FuentePorOmision={Arial, 8, Negro, []}
Caracteres=400
TamanoPagina=2
AnchoPagina=74.4
LargoPagina=27.9
MargenArriba=1
MargenAbajo=1
MargenIzquierdo=1
MargenDerecho=1
FormatoSinConexion=S
ASCIISinModos=S
Puerto=LPT1
Parametros=S
ImpresoraModo=Normal
FormatoAscii=S
AsciiPorOmision=S
ArchivoEspecifico=F:DireccionGral\Direccion\MONEDERO.txt
ASCIISinSaltos=S
PosicionInicialAlturaCliente=423
PosicionInicialAncho=630
[Vista]
Icono=0
Clave=RM1006MonederoRep
VistaIndependiente=S
ListaCampos=UEN<BR>tarjEntreg<BR>tarjUsadas<BR>tarjSdo<BR>PtosSaldo<BR>NCgo<BR>ImpNCgo<BR>tarjNuevas<BR>tarjGenera<BR>PtosGenera<BR>tarjRedime<BR>PtosRedime<BR>ImpFacRedime<BR>tarjAumento<BR>ImpAumento<BR>tarjDisminucion<BR>ImpDisminucion
BaseSR=S
SQL=declare <BR>@fechad nvarchar(max),<BR>@fechaa nvarchar(max)<BR><BR>set @fechad = <T>{Fechaformatoservidor(Info.FechaD)}<T><BR>set @fechaa = <T>{Fechaformatoservidor(Info.FechaA)}<T><BR><BR>--query general<BR>SELECT u.UEN ,te.tarjEntreg,<BR><TAB>tu.tarjUsadas,<BR><TAB>ts.tarjSdo,ts.PtosSaldo,<BR><TAB>nc.NCgo,nc.ImpNCgo,<BR><TAB>tn.tarjNuevas,<BR><TAB>tgp.tarjGenera,<BR><TAB>pG.PtosGenera,<BR><TAB>trp.tarjRedime,<BR><TAB>pp.PtosRedime,<BR><TAB>pp.ImpFacRedime,<BR><TAB>ta.tarjAumento,<BR><TAB>Aj.ImpAumento,<BR><TAB>td.tarjDisminucion,<BR><TAB>Aj.ImpDisminucion<BR><BR>FROM UEN u<BR>LEFT JOIN ( -- tarjetas entregadas  ya sea en su primer venta  o x movtos admvos<BR><TAB><TAB> SELECT te.UEN, tarjEntreg=count(*)  <BR><TAB><TAB> FROM ( -- serie y su uen<BR><TAB><TAB><TAB>  SELECT DISTINCT Serie, U<CONTINUA>
SQL002=<CONTINUA>en <BR><TAB><TAB><TAB>  FROM ( --union de 1a vez de tarjetaseriemovmavi y monederomavi en un movto admvo<BR><TAB><TAB><TAB><TAB>  SELECT <T>t<T> as origen,TS.SERIE,ts.sucursal,S.WUen as Uen<BR><TAB><TAB><TAB><TAB>  FROM v_TARJETASERIEMOVMAVISuc ts<BR><TAB><TAB><TAB><TAB>  LEFT JOIN Sucursal s  on s.sucursal = ts.sucursal<BR><TAB><TAB><TAB><TAB>  WHERE TS.ROW = 1<BR><TAB><TAB><TAB><TAB> UNION ALL<BR>     <TAB><TAB>      SELECT <T>m<T> as origen,ts.Serie,ts.Sucursal,S.WUen as Uen<BR><TAB><TAB><TAB><TAB>  FROM ( <TAB>-- tarjetas con movtos admvos y sucursal y uen de sucursal<BR><TAB><TAB><TAB><TAB><TAB>   SELECT CASE when ts.Sucursal is null then m.sucursal else ts.sucursal end as sucursal,<BR><TAB><TAB><TAB><TAB><TAB><TAB><TAB> md.Serie<BR><TAB><TAB><TAB><TAB><TAB>   FROM MONEDEROMAVId md in<CONTINUA>
SQL003=<CONTINUA>ner join monederomavi m on m.id = md.id<BR> <TAB><TAB><TAB><TAB><TAB>   LEFT JOIN v_TARJETASERIEMOVMAVISuc ts  on ts.serie = md.serie and ts.row = 1<BR><TAB><TAB><TAB><TAB><TAB>   LEFT JOIN Sucursal s  on s.sucursal = m.sucursal<BR><TAB><TAB><TAB><TAB><TAB>   WHERE m.mov in (<T>Aumento Saldo<T>,<T>Disminucion Saldo<T>)<BR><TAB><TAB><TAB><TAB><TAB><TAB>and m.estatus = <T>concluido<T><BR><TAB><TAB><TAB><TAB><TAB><TAB>and ts.serie is null<BR><TAB><TAB><TAB><TAB><TAB><TAB>) TS<BR><TAB><TAB><TAB><TAB>  LEFT JOIN Sucursal s  on s.sucursal = ts.sucursal<BR> <TAB><TAB><TAB><TAB>   ) TE<BR><TAB><TAB><TAB><TAB>)TE <BR><TAB><TAB>GROUP BY te.UEN<TAB><BR><TAB>) TE ON te.uen = u.uen<BR><BR>LEFT JOIN ( -- tarjetas Usadas <BR><TAB><TAB>SELECT x.UEN,tarjUsadas=count(*)<BR><TAB><TAB>from (<BR>            se<CONTINUA>
SQL004=<CONTINUA>lect distinct S.wuen as uen,x.sucursal,cuenta <BR>            FROM ( -- cuenta de auxiliarp y obtiene su sucursal<BR>                SELECT CUENTA,<BR><TAB><TAB><TAB><TAB>     CASE WHEN v.sucursalventa is null THEN cs.Sucursal  ELSE v.sucursalventa END as sucursal<BR><TAB><TAB><TAB><TAB>from auxiliarp ap <BR><TAB><TAB><TAB>    LEFT JOIN VENTA V ON V.ID = ap.moduloId and ap.modulo = <T>vtas<T><BR><TAB><TAB><TAB>    LEFT JOIN (<BR><TAB><TAB><TAB><TAB><TAB><TAB>SELECT CASE when ts.Sucursal is null then m.sucursal else ts.sucursal end as sucursal,<BR><TAB><TAB><TAB><TAB><TAB><TAB><TAB>md.Serie<BR><TAB><TAB><TAB><TAB><TAB><TAB>FROM MONEDEROMAVId md inner join monederomavi m on m.id = md.id<BR><TAB><TAB><TAB><TAB><TAB><TAB>LEFT JOIN v_TARJETASERIEMOVMAVISuc ts  on ts.serie = md.serie and ts.row <CONTINUA>
SQL005=<CONTINUA>= 1<BR><TAB><TAB><TAB><TAB><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = m.sucursal<BR><TAB><TAB><TAB><TAB><TAB><TAB>WHERE m.mov in (<T>Aumento Saldo<T>,<T>Disminucion Saldo<T>)<BR><TAB><TAB><TAB><TAB><TAB><TAB>and m.estatus = <T>concluido<T><BR><TAB><TAB><TAB><TAB><TAB><TAB>and ts.serie is null<BR><TAB><TAB><TAB><TAB><TAB><TAB>  ) cs on cs.serie = ap.cuenta <BR>                 ) X<BR><TAB><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = x.sucursal<BR><TAB><TAB><TAB>) x<BR><TAB>GROUP BY x.uen<BR><TAB><TAB>) TU ON TU.uen = u.uen<BR><BR>LEFT JOIN ( -- tarjetas con saldo,  y saldo en puntos <BR><TAB><TAB>SELECT ts.Uen,tarjSdo=count(*) ,PtosSaldo=SUM(SALDO)  <BR><TAB><TAB>from (<BR><TAB><TAB><TAB>SELECT ms.Uen,ms.sucursal,Cuenta,SUM(SALDO) as Saldo <BR><TAB><TAB><TAB>FROM SALDOP sp<BR><TAB><<CONTINUA>
SQL006=<CONTINUA>TAB><TAB>LEFT JOIN (  -- sucursal en q se activo la tarjeta<BR><TAB><TAB><TAB><TAB>     SELECT s.wuen as uen,ts.sucursal,TS.SERIE<BR><TAB><TAB><TAB><TAB>     FROM v_TARJETASERIEMOVMAVISuc ts<BR><TAB><TAB><TAB><TAB>     LEFT JOIN Sucursal s  on s.sucursal = ts.sucursal<BR><TAB><TAB><TAB><TAB>     WHERE TS.ROW = 1<BR>    <TAB><TAB><TAB>    UNION ALL<BR><TAB>     <TAB><TAB>     SELECT distinct s.wuen as uen,ts.Sucursal,ts.Serie<BR><TAB><TAB><TAB>         FROM ( <TAB><BR><TAB><TAB><TAB>             SELECT CASE when ts.Sucursal is null then m.sucursal else ts.sucursal end as sucursal,<BR><TAB><TAB><TAB>                   md.Serie<BR><TAB><TAB><TAB><TAB><TAB>     FROM MONEDEROMAVId md inner join monederomavi m on m.id = md.id<BR> <TAB><TAB>                 LEFT JOIN v_TARJETASERIEMOVMAVISuc ts  <CONTINUA>
SQL007=<CONTINUA>on ts.serie = md.serie and ts.row = 1<BR><TAB><TAB><TAB>             LEFT JOIN Sucursal s  on s.sucursal = m.sucursal<BR><TAB><TAB><TAB>             WHERE m.mov in (<T>Aumento Saldo<T>,<T>Disminucion Saldo<T>)<BR><TAB><TAB><TAB><TAB><TAB><TAB>and m.estatus = <T>concluido<T><BR><TAB><TAB><TAB><TAB><TAB><TAB>and ts.serie is null<BR><TAB> <TAB><TAB><TAB><TAB>     ) TS<BR><TAB><TAB><TAB><TAB><TAB> LEFT JOIN Sucursal s  on s.sucursal = ts.sucursal<BR><TAB><TAB><TAB><TAB><TAB>) ms on ms.serie = sp.cuenta<BR><TAB><TAB><TAB>GROUP BY ms.uen,ms.sucursal,sp.cuenta<BR><TAB><TAB><TAB>) TS<BR><TAB><TAB>WHERE ts.Saldo <> 0<BR><TAB><TAB>GROUP BY ts.Uen<BR><TAB><TAB>) TS ON TS.Uen = u.Uen<BR><BR>LEFT JOIN ( -- notas Cargo <BR><TAB>SELECT x.Uen,NCgo=COUNT(*),ImpNCgo=SUM(x.IMPORTE+x.IMPUESTOS) <BR><TAB><TAB><CONTINUA>
SQL008=<CONTINUA>from (<BR>        SELECT s.wuen as uen,<BR><TAB><TAB><TAB>   CASE when ts.sucursal is null then cc.sucursal else ts.sucursal end as sucursal,<BR><TAB><TAB><TAB>   cc.observaciones,<TAB><BR><TAB><TAB><TAB>   cc.importe,cc.impuestos<BR><TAB><TAB>FROM CXC CC <BR><TAB><TAB>INNER JOIN movtipo MT ON MODULO= <T>CXC<T> AND CLAVE = <T>CXC.CA<T> AND CC.MOV = MT.MOV<BR>        LEFT JOIN v_TARJETASERIEMOVMAVISuc ts  on ts.row = 1 and ts.serie = cc.observaciones  <BR>        LEFT JOIN Sucursal s  on s.sucursal = ts.sucursal<BR><TAB><TAB>WHERE cc.CONCEPTO = <T>MONEDERO ELECTRONICO<T> AND cc.ESTATUS = <T>PENDIENTE<T><BR><TAB><TAB>)x<BR><TAB><TAB>GROUP BY x.uen<BR><TAB><TAB>) nc on nc.Uen = u.Uen<BR>-- entre  fechad  y  fechah<BR>LEFT JOIN ( -- PtosGenerados<BR><TAB><TAB>SELECT s.wuen as uen,--v.SucursalV<CONTINUA>
SQL009=<CONTINUA>enta as Sucursal,vc.categoria,<BR><TAB><TAB>   PtosGenera=sum(Case when left(ap.mov,3)=<T>Fac<T> then cargo else 0 end) - sum(CASE when left(ap.mov,3)=<T>dev<T> then abono else 0 end) <BR><TAB><TAB>FROM AUXILIARP ap<BR><TAB><TAB>LEFT JOIN VENTA V ON V.ID = ap.moduloId and ap.modulo = <T>vtas<T><BR><TAB>    LEFT JOIN VENTASCANALMAVI VC ON VC.ID = V.ENVIARA<TAB><BR><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = v.sucursalventa<BR><TAB><TAB>WHERE 1=1 and FECHA BETWEEN @FECHAD AND  @FECHAA <BR><TAB><TAB><TAB>and ap.modulo = <T>vtas<T><BR><TAB><TAB>GROUP by s.wuen--, v.SucursalVenta,vc.categoria<BR><TAB><TAB>) PG on PG.Uen = u.uen<BR><BR>LEFT JOIN ( -- PtosRedimidos, ImpFacturas q Redimen<BR><TAB><TAB>SELECT s.wuen as Uen,<BR><TAB><TAB>   PtosRedime=sum(Case when left(ap.mov,3)=<T>Fac<T> then <CONTINUA>
SQL010=<CONTINUA>abono else 0 end) - sum(CASE when left(ap.mov,3)=<T>dev<T> then cargo else 0 end), <BR><TAB><TAB>   ImpFacRedime=sum(CASE when abono> 0 and left(ap.mov,3)=<T>fac<T>  then v.importe+v.impuestos else 0 end) <BR><TAB><TAB>FROM AUXILIARP ap<BR><TAB><TAB><TAB>LEFT JOIN VENTA V ON V.ID = ap.moduloId and ap.modulo = <T>vtas<T>  -- datos de la venta q redimio<BR><TAB><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = v.sucursalventa<BR><TAB><TAB>    LEFT JOIN v_TARJETASERIEMOVMAVISuc ts ON ts.serie = ap.cuenta and TS.ROW = 1<BR><TAB><TAB><TAB>LEFT JOIN VENTA V1 ON V1.ID = ts.Id<TAB><TAB><TAB>-- datos de la primera venta de la tarjeta<BR><TAB><TAB>    LEFT JOIN VENTASCANALMAVI VC ON VC.ID = V1.ENVIARA<TAB><BR><TAB><TAB>WHERE 1=1 and FECHA BETWEEN @FECHAD AND  @FECHAA <BR><TAB><TAB><TAB>and ap.modulo =<CONTINUA>
SQL011=<CONTINUA> <T>vtas<T><BR><TAB><TAB>GROUP by s.wuen<BR><TAB><TAB>) PP on Pp.Uen = u.uen<BR><BR>LEFT JOIN ( -- tarjetas Generaron en el Periodo<BR><TAB><TAB>select X.wuen as Uen, tarjGenera=count(*)  <BR><TAB><TAB>from (<BR><TAB><TAB><TAB>SELECT  distinct<BR><TAB><TAB><TAB><TAB><TAB>s.wuen,v.sucursalventa as Sucursal,<BR><TAB><TAB><TAB><TAB><TAB> CUENTA<BR><TAB><TAB><TAB><TAB>from auxiliarp ap <BR><TAB><TAB><TAB>    LEFT JOIN VENTA V ON V.ID = ap.moduloId and ap.modulo = <T>vtas<T><BR><TAB><TAB><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = v.sucursalventa<BR><TAB><TAB><TAB><TAB>WHERE 1=1 and FECHA BETWEEN @FECHAD AND  @FECHAA <BR><TAB><TAB><TAB><TAB><TAB>and ap.cargo is not null <BR><TAB><TAB><TAB><TAB><TAB>and ap.mov in (<T>Factura<T>,<T>Factura VIU<T>, <T>Factura Mayoreo<T>)<BR><TAB><TAB><TAB><TAB<CONTINUA>
SQL012=<CONTINUA>><TAB>and ap.modulo = <T>VTAS<T><BR> <TAB><TAB><TAB>) x<BR><TAB><TAB>GROUP BY x.wuen<BR><TAB><TAB>) TGP on TGP.UEN = U.uEN<BR><BR>LEFT JOIN ( -- tarjetas Redimieron en el Periodo<BR><TAB><TAB>Select x.wUen as Uen,tarjRedime=count(*)  from (<BR><TAB><TAB><TAB>Select distinct s.wuen,cuenta from auxiliarp ap<BR><TAB><TAB><TAB><TAB>LEFT JOIN VENTA V ON V.ID = ap.moduloId and ap.modulo = <T>vtas<T><BR><TAB><TAB><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = v.sucursalventa<BR><TAB><TAB><TAB>WHERE 1=1 and FECHA BETWEEN @FECHAD AND  @FECHAA<BR><TAB><TAB><TAB><TAB>and ap.abono is not null <BR><TAB><TAB><TAB><TAB>and ap.mov in (<T>Factura<T>,<T>Factura VIU<T>, <T>Factura Mayoreo<T>)<BR><TAB><TAB><TAB><TAB>and ap.modulo = <T>VTAS<T><BR><TAB><TAB><TAB>) x<BR><TAB><TAB>GROUP BY x.wuen<BR><TAB><TAB>) <CONTINUA>
SQL013=<CONTINUA>trp on trp.uen = U.uen<BR><BR>LEFT JOIN ( -- tarjetas nuevas  en esta quincena<BR><TAB><TAB>SELECT Uen,tarjNuevas=count(*) <BR><TAB><TAB>FROM (  -- tarjetas nuevas <BR><TAB><TAB>  SELECT DISTINCT Tn.UEN, Tn.SERIE<TAB><BR><TAB><TAB>  FROM (<BR> <TAB><TAB><TAB>   SELECT <T>t<T> as origen,S.WUen as Uen,ts.sucursal,TS.SERIE,v.fechaemision<BR><TAB><TAB><TAB>   FROM v_TARJETASERIEMOVMAVISuc ts<BR><TAB><TAB><TAB>   LEFT JOIN Venta v on v.id = ts.id<BR><TAB><TAB><TAB>   LEFT JOIN Sucursal s  on s.sucursal = ts.sucursal<BR><TAB><TAB><TAB>   WHERE TS.ROW = 1 and v.FECHAEMISION BETWEEN @FECHAD AND  @FECHAA<BR><TAB><TAB><TAB>  UNION ALL<BR><TAB><TAB><TAB>   SELECT <T>m<T> as origen,S.WUen as Uen,Ts.SUCURSAL,ts.serie,ts.fechaemision <BR><TAB><TAB><TAB>   FROM (<BR><TAB><TAB><TAB><TAB>    SELECT <BR><TA<CONTINUA>
SQL014=<CONTINUA>B><TAB><TAB><TAB>      CASE when ts.Sucursal is null then m.sucursal else ts.sucursal end as sucursal,<BR><TAB><TAB><TAB><TAB>      md.Serie,m.fechaemision<BR><TAB><TAB><TAB><TAB>    FROM MONEDEROMAVId md inner join monederomavi m on m.id = md.id<BR><TAB><TAB><TAB><TAB>    LEFT JOIN v_TARJETASERIEMOVMAVISuc ts  on ts.serie = md.serie and ts.row = 1<BR><TAB><TAB><TAB><TAB>    WHERE m.mov in (<T>Aumento Saldo<T>,<T>Disminucion Saldo<T>) <BR><TAB><TAB><TAB><TAB><TAB><TAB>and m.estatus = <T>concluido<T><BR><TAB><TAB><TAB><TAB><TAB><TAB>and m.FECHAEMISION BETWEEN @FECHAD AND  @FECHAA<BR><TAB><TAB><TAB><TAB><TAB>and ts.serie is null<BR><TAB><TAB> <TAB><TAB><TAB>) TS<BR><TAB><TAB><TAB><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = ts.sucursal<BR><TAB><TAB><TAB><TAB>) tn<TAB><TAB><BR><TAB>       <CONTINUA>
SQL015=<CONTINUA> ) TE<TAB><BR><TAB><TAB>GROUP BY te.UEN<BR><TAB><TAB>)TN on tn.Uen = u.Uen<BR>LEFT JOIN ( -- tarjetas con Aumento Saldo <BR><TAB><TAB>SELECT x.UEN,tarjAumento=count(*)<BR><TAB>from (<BR>            select distinct S.wuen as uen,cuenta <BR>            FROM ( -- cuenta de auxiliarp y obtiene su sucursal<BR>                SELECT CUENTA,<BR><TAB><TAB><TAB><TAB>     CASE WHEN v.sucursalventa is null THEN cs.Sucursal  ELSE v.sucursalventa END as sucursal<BR><TAB><TAB><TAB><TAB>from auxiliarp ap <BR><TAB><TAB><TAB>    LEFT JOIN VENTA V ON V.ID = ap.moduloId and ap.modulo = <T>Vtas<T><BR><TAB><TAB><TAB>    LEFT JOIN (<BR><TAB><TAB><TAB><TAB><TAB><TAB>SELECT CASE when ts.Sucursal is null then m.sucursal else ts.sucursal end as sucursal,<BR><TAB><TAB><TAB><TAB><TAB><TAB><TAB>md.Serie<BR><TAB><TAB><<CONTINUA>
SQL016=<CONTINUA>TAB><TAB><TAB><TAB>FROM MONEDEROMAVId md inner join monederomavi m on m.id = md.id<BR><TAB><TAB><TAB><TAB><TAB><TAB>LEFT JOIN v_TARJETASERIEMOVMAVISuc ts  on ts.serie = md.serie and ts.row = 1<BR><TAB><TAB><TAB><TAB><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = m.sucursal<BR><TAB><TAB><TAB><TAB><TAB><TAB>WHERE m.mov in (<T>Aumento Saldo<T>,<T>Disminucion Saldo<T>) and m.estatus = <T>concluido<T><BR><TAB><TAB><TAB><TAB><TAB><TAB>  ) cs on cs.serie = ap.cuenta <BR><TAB><TAB><TAB>WHERE 1=1 and FECHA BETWEEN @FECHAD AND  @FECHAA<BR><TAB><TAB><TAB>and ap.modulo = <T>Monel<T> and ap.mov = <T>Aumento Saldo<T><BR>                 ) X<BR><TAB><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = x.sucursal<BR><TAB><TAB><TAB>) x<BR><TAB><TAB>GROUP BY x.uen<BR><TAB><TAB>) TA ON TA.Uen = u.Uen<BR><BR>LEFT<CONTINUA>
SQL017=<CONTINUA> JOIN ( -- tarjetas con Disminucion Saldo <BR><TAB><TAB>SELECT x.UEN,tarjDisminucion=count(*)<BR><TAB><TAB>from (<BR>            select distinct S.wuen as uen,cuenta <BR>            FROM ( -- cuenta de auxiliarp y obtiene su sucursal<BR>                SELECT CUENTA,<BR><TAB><TAB><TAB><TAB>     CASE WHEN v.sucursalventa is null THEN cs.Sucursal  ELSE v.sucursalventa END as sucursal<BR><TAB><TAB><TAB><TAB>from auxiliarp ap <BR><TAB><TAB><TAB>    LEFT JOIN VENTA V ON V.ID = ap.moduloId and ap.modulo = <T>Vtas<T><BR><TAB><TAB><TAB>    LEFT JOIN (<BR><TAB><TAB><TAB><TAB><TAB><TAB>SELECT CASE when ts.Sucursal is null then m.sucursal else ts.sucursal end as sucursal,<BR><TAB><TAB><TAB><TAB><TAB><TAB><TAB>md.Serie<BR><TAB><TAB><TAB><TAB><TAB><TAB>FROM MONEDEROMAVId md inner join monederomavi m on<CONTINUA>
SQL018=<CONTINUA> m.id = md.id<BR><TAB><TAB><TAB><TAB><TAB><TAB>LEFT JOIN v_TARJETASERIEMOVMAVISuc ts  on ts.serie = md.serie and ts.row = 1<BR><TAB><TAB><TAB><TAB><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = m.sucursal<BR><TAB><TAB><TAB><TAB><TAB><TAB>WHERE m.mov in (<T>Aumento Saldo<T>,<T>Disminucion Saldo<T>) and m.estatus = <T>concluido<T><BR><TAB><TAB><TAB><TAB><TAB><TAB>  ) cs on cs.serie = ap.cuenta <BR><TAB><TAB><TAB>WHERE 1=1 and FECHA BETWEEN @FECHAD AND  @FECHAA<BR><TAB><TAB><TAB>and ap.modulo = <T>Monel<T> and ap.mov = <T>Disminucion Saldo<T><BR>                 ) X<BR><TAB><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = x.sucursal<BR><TAB><TAB><TAB>) x<BR><TAB><TAB>GROUP BY x.uen<BR><TAB><TAB>) TD ON TD.Uen = u.Uen<BR><BR>LEFT JOIN ( -- Importes con Aumento Saldo <BR><TAB><TAB>SELECT x.UEN,<CONTINUA>
SQL019=<CONTINUA>sum(Cargo) as ImpAumento, sum(Abono) as ImpDisminucion<BR><TAB><TAB>FROM (<BR>            select S.wuen as uen,x.sucursal,cuenta,Cargo,Abono <BR>            FROM ( -- cuenta de auxiliarp y obtiene su sucursal<BR><TAB><TAB><TAB><TAB>SELECT CUENTA,Cargo,Abono,<BR><TAB><TAB><TAB><TAB>     CASE WHEN v.sucursalventa is null THEN cs.Sucursal  ELSE v.sucursalventa END as sucursal<BR><TAB><TAB><TAB><TAB>FROM auxiliarp ap <BR><TAB><TAB><TAB>    LEFT JOIN VENTA V ON V.ID = ap.moduloId and ap.modulo = <T>Vtas<T><BR><TAB><TAB><TAB>    LEFT JOIN (<BR><TAB><TAB><TAB><TAB><TAB><TAB>SELECT CASE when ts.Sucursal is null then m.sucursal else ts.sucursal end as sucursal,<BR><TAB><TAB><TAB><TAB><TAB><TAB><TAB>md.Serie<BR><TAB><TAB><TAB><TAB><TAB><TAB>FROM MONEDEROMAVId md inner join monederomavi m on m.id = m<CONTINUA>
SQL020=<CONTINUA>d.id<BR><TAB><TAB><TAB><TAB><TAB><TAB>LEFT JOIN v_TARJETASERIEMOVMAVISuc ts  on ts.serie = md.serie and ts.row = 1<BR><TAB><TAB><TAB><TAB><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = m.sucursal<BR><TAB><TAB><TAB><TAB><TAB><TAB>WHERE m.mov in (<T>Aumento Saldo<T>,<T>Disminucion Saldo<T>) and m.estatus = <T>concluido<T><BR><TAB><TAB><TAB><TAB><TAB><TAB>  ) cs on cs.serie = ap.cuenta <BR><TAB><TAB><TAB><TAB>WHERE 1=1 and FECHA BETWEEN @FECHAD AND  @FECHAA<BR><TAB><TAB><TAB><TAB>and ap.modulo = <T>Monel<T>-- and ap.mov = <T>Disminucion Saldo<T><BR>                 ) X<BR><TAB><TAB><TAB>LEFT JOIN Sucursal s  on s.sucursal = x.sucursal<BR><TAB><TAB><TAB>) x<BR><TAB><TAB>GROUP BY x.uen<BR><TAB><TAB>) Aj ON Aj.Uen = u.Uen<BR>ORDER BY UEN
[UEN]
Clave=UEN
Nombre=UEN
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=UEN
[tarjEntreg]
Clave=tarjEntreg
Nombre=tarjEntreg
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=tarjEntreg
[tarjUsadas]
Clave=tarjUsadas
Nombre=tarjUsadas
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=tarjUsadas
[tarjSdo]
Clave=tarjSdo
Nombre=tarjSdo
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=tarjSdo
[PtosSaldo]
Clave=PtosSaldo
Nombre=PtosSaldo
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=NumMonetario
ClaveBDE=PtosSaldo
[NCgo]
Clave=NCgo
Nombre=NCgo
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=NCgo
[ImpNCgo]
Clave=ImpNCgo
Nombre=ImpNCgo
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=NumMonetario
ClaveBDE=ImpNCgo
[tarjNuevas]
Clave=tarjNuevas
Nombre=tarjNuevas
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=tarjNuevas
[tarjGenera]
Clave=tarjGenera
Nombre=tarjGenera
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=tarjGenera
[PtosGenera]
Clave=PtosGenera
Nombre=PtosGenera
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=NumMonetario
ClaveBDE=PtosGenera
[tarjRedime]
Clave=tarjRedime
Nombre=tarjRedime
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=tarjRedime
[PtosRedime]
Clave=PtosRedime
Nombre=PtosRedime
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=NumMonetario
ClaveBDE=PtosRedime
[ImpFacRedime]
Clave=ImpFacRedime
Nombre=ImpFacRedime
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=NumMonetario
ClaveBDE=ImpFacRedime
[Formato]
VentanaIzquierda=-8
VentanaArriba=-8
VentanaAltura=1040
VentanaAncho=1296
PanelArriba=260
PanelBotones=80
ListaLineas=Título<BR>Título<BR>Detalle
[Linea1]
Clave=Título
Objetos=1
Seccion=Título
AltoEnCm=0.372
Renglones=1
[Linea2]
Clave=Título
Objetos=1
Seccion=Título
AltoEnCm=0.372
Renglones=1
[Linea3]
Clave=Detalle
Objetos=1
Seccion=Detalle
AltoEnCm=0.372
Renglones=1
[A1]
Celda=A1
Alineacion=Izquierda
AnchoEnCm=55.8
AnchoTexto=300
TablaAncho=(Auto)
TablaAnchoCeldas=(Auto)
TablaAnchoTituloRenglon=(Auto)
TablaAnchoTotales=(Auto)
Expresion=<T>De: <T>+FechaAMD(Info.FechaD)+<T> Hasta: <T>+FechaAMD(Info.FechaA)
[A2]
Celda=A2
Alineacion=Izquierda
AnchoEnCm=55.8
ExpresionMultiple=S
AnchoTexto=300
TablaAncho=(Auto)
TablaAnchoCeldas=(Auto)
TablaAnchoTituloRenglon=(Auto)
TablaAnchoTotales=(Auto)
Expresion=<T>UEN|tarjEntreg|tarjUsadas|tarjSdo|PtosSaldo|NCgo|ImpNCgo|tarjNuevas|tarjGenera|PtosGenera|tarjRedime|PtosRedime|ImpFacRedime|tarjAumento|ImpAumento|tarjDisminucion|ImpDisminucion<T>
[A3]
Celda=A3
Alineacion=Izquierda
AnchoEnCm=55.8
ExpresionMultiple=S
AnchoTexto=300
TablaAncho=(Auto)
TablaAnchoCeldas=(Auto)
TablaAnchoTituloRenglon=(Auto)
TablaAnchoTotales=(Auto)
Expresion=<T><T>+UEN+<T>|<T>+tarjEntreg+<T>|<T>+tarjUsadas+<T>|<T>+tarjSdo+<T>|<T>+PtosSaldo+<T>|<T>+NCgo+<T>|<T>+ImpNCgo+<T>|<T>+tarjNuevas+<T>|<T>+tarjGenera+<T>|<T>+PtosGenera+<T>|<T>+tarjRedime+<T>|<T>+PtosRedime+<T>|<T>+ImpFacRedime+<T>|<T>+tarjAumento+<T>|<T>+ImpAumento+<T>|<T>+tarjDisminucion+<T>|<T>+ImpDisminucion+<T><T>
[tarjAumento]
Clave=tarjAumento
Nombre=tarjAumento
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=tarjAumento
[ImpAumento]
Clave=ImpAumento
Nombre=ImpAumento
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=NumMonetario
ClaveBDE=ImpAumento
[tarjDisminucion]
Clave=tarjDisminucion
Nombre=tarjDisminucion
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=tarjDisminucion
[ImpDisminucion]
Clave=ImpDisminucion
Nombre=ImpDisminucion
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=NumMonetario
ClaveBDE=ImpDisminucion
