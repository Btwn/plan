[Reporte]
Clave=RM1021EnvioCV064TxtRep
Nombre=RM1021EnvioCV064TxtRep
Icono=0
VistaEspecial=S
Tipo=Reporte
SubmenuPreliminar=S
ImpresoraEspecifica=(por Omisión)
ImpresoraPixeles=(Auto)
ImpresoraFactor=(Auto)
ImpresoraAlto=(Auto)
FuentePorOmision={Arial, 8, Negro, []}
Caracteres=132
Renglones=66
MargenInferior=2
TamanoPagina=2
AnchoPagina=24.552
LargoPagina=27.9
MargenArriba=1
MargenAbajo=1
MargenIzquierdo=1
MargenDerecho=1
FormatoSinConexion=S
Puerto=LPT1
Parametros=S
FormatoAscii=S
PosicionInicialAlturaCliente=968
PosicionInicialAncho=1288
AsciiPorOmision=S
ArchivoEspecifico=c:\RM1021EnvioCV064RepTxt
[Vista]
Icono=0
Clave=RM1021EnvioCV064TxtRep
VistaIndependiente=S
ListaCampos=Dato
SQL=SELECT DATO=(A+B+C+D+E+F) FROM(<BR>SELECT <BR>A=(CONVERT(VARCHAR(13),ISNULL(RFCInstitucion,<T><T>)+<T>-------------<T>)),<BR>B=ISNULL(Concepto,<T><T>),<BR>C=CONVERT(VARCHAR,CODIGO),<BR>D= CONVERT(VARCHAR,MIN(DESDE)),<BR>E= ISNULL(MAX(HASTA),<T>999999<T>),<BR>F= CONVERT(VARCHAR,ISNULL(IMPORTE,<T>0.00<T>))<BR>FROM (<TAB><BR>SELECT<BR><TAB>T.RFCInstitucion,<BR><TAB>T.Nombre,<BR><TAB>T.Concepto,<BR><TAB>T.CODIGO,<BR><TAB>DESDE = MIN(T.DESDE),<BR><TAB>HASTA = MAX(F.FINAL),<BR><TAB>T.IMPORTE<BR>FROM (<BR>SELECT <BR><TAB>C.RFCInstitucion,<BR><TAB>CTE.Nombre,<BR><TAB>Concepto=ISNULL(c.ClaveInst,<T>72<T>),<BR><TAB>CODIGO = H.TipoEnvio,<BR><TAB>DESDE = SUBSTRING(CONVERT(varchar,H.FechaEmision,102),1,4)+ dbo.Fn_MaviNumQuincena(H.FechaRegistro)+1,<BR><TAB>HASTA = CASE WHEN H.TipoEnvio = <T>B<T> THEN <<CONTINUA>
SQL002=<CONTINUA>T>999999<T>ELSE (SUBSTRING(CONVERT(VARCHAR,DATEADD(MM,H.NoDocs,H.FechaEmision),102),1,4)+ DBO.Fn_MaviNumQuincena(DATEADD(MM,H.NoDocs,H.FechaEmision))) END,<BR><TAB>IMPORTE = H.DescCte/2<BR><BR>FROM MaviEnvDispElectHist H WITH(NOLOCK)<BR>INNER JOIN dbo.CteEnviarA C WITH(NOLOCK)ON H.IDCanalVenta = C.ID AND H.Cliente = C.Cliente<BR>INNER JOIN CTE WITH(NOLOCK)ON CTE.Cliente = H.Cliente<BR>WHERE H.IDCanalVenta = 64<BR><BR>{Si(ConDatos(Info.Ejercicio),<T> And H.Ejercicio=<T>+Info.Ejercicio,<T><T>)}<BR>{Si(ConDatos(Info.Periodo),<T> And H.Periodo=<T>+Info.Periodo,<T><T>)}<BR>{Si(ConDatos(Info.Quincena),<T> And H.Quincena=<T>+Info.Quincena,<T><T>)}<BR><BR>)T<BR><BR>LEFT JOIN (<BR><TAB><TAB><TAB>SELECT <BR><TAB><TAB><TAB><TAB>NOMBRE,<BR><TAB><TAB><TAB><TAB>TipoEnvio,<BR><TAB><TAB><TAB><TAB>FINAL= C<CONTINUA>
SQL003=<CONTINUA>ASE WHEN TipoEnvio = <T>B<T> THEN <T>999999<T> ELSE SUBSTRING( CONVERT(VARCHAR,(MAX(FIN)),102), 1,4) + DBO.Fn_MaviNumQuincena(MAX(FIN)) END<BR><BR><TAB><TAB><TAB>FROM(<BR><TAB><TAB><TAB><TAB>SELECT <BR><TAB><TAB><TAB><TAB><TAB>cte.Nombre,<BR><TAB><TAB><TAB><TAB><TAB>FIN = MAX(DATEADD(MM,H.NoDocs,H.FechaEmision)),<BR><TAB><TAB><TAB><TAB><TAB>H.TipoEnvio<BR><TAB><TAB><TAB><TAB>FROM MaviEnvDispElectHist H WITH(NOLOCK)<BR><TAB><TAB><TAB><TAB>INNER JOIN CTE WITH(NOLOCK)ON CTE.Cliente = H.Cliente<BR><TAB><TAB><TAB><TAB>INNER JOIN dbo.Cxcpendiente c ON c.PadreMAVI = h.Mov AND c.PadreIDMAVI = h.MovID<BR><TAB><TAB><TAB><TAB>GROUP BY CTE.Nombre,H.FechaEmision,H.TipoEnvio<BR><TAB><TAB><TAB><TAB>)KK<BR><TAB><TAB><TAB>GROUP BY KK.Nombre,KK.TipoEnvio,kk.FIN<BR><TAB><TAB>  )F ON F.NOMBRE = T.Nombre<BR><B<CONTINUA>
SQL004=<CONTINUA>R>GROUP BY T.RFCInstitucion,T.Nombre,T.Concepto,T.CODIGO,T.IMPORTE,F.FINAL<BR>)T<BR>GROUP BY T.RFCInstitucion,Nombre,Concepto,CODIGO,T.IMPORTE<BR>)TODO<BR>ORDER BY C,A
[Formato]
ListaLineas=Detalle
VentanaIzquierda=0
VentanaArriba=0
VentanaAltura=780
VentanaAncho=1036
PanelArriba=120
PanelBotones=80
[Linea1]
Clave=Detalle
Objetos=1
Seccion=Detalle
AltoEnCm=0.372
Renglones=1
[A1]
Celda=A1
Alineacion=Izquierda
AnchoEnCm=8.184
AnchoTexto=44
TablaAncho=(Auto)
TablaAnchoCeldas=(Auto)
TablaAnchoTituloRenglon=(Auto)
TablaAnchoTotales=(Auto)
Expresion=Dato
[Dato]
Clave=Dato
Nombre=Dato
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=161
TipoDatos=Texto
Tamano=124
ClaveBDE=dato
