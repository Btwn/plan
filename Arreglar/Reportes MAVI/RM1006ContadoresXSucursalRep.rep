[Reporte]
Clave=RM1006ContadoresXSucursalRep
Nombre=Comparativo Ventas Dirección
Icono=0
VistaEspecial=S
Tipo=Reporte
ImpresoraEspecifica=(por Omisión)
ImpresoraPixeles=(Auto)
ImpresoraFactor=(Auto)
ImpresoraAlto=(Auto)
FuentePorOmision={Arial, 8, Negro, []}
ImpresoraModo=Comprimido
Caracteres=132
Renglones=66
MargenInferior=2
TamanoPagina=2
AnchoPagina=24.552
LargoPagina=27.9
FormatoAscii=S
MargenArriba=1
MargenAbajo=1
MargenIzquierdo=1
MargenDerecho=1
FormatoSinConexion=S
AsciiPorOmision=S
ArchivoEspecifico=F:\DireccionGral\Direccion\CONTADORESXSUCURSAL.txt
Puerto=LPT1
Parametros=S
PosicionInicialAlturaCliente=423
PosicionInicialAncho=630
[Formato]
VentanaIzquierda=55
VentanaArriba=114
VentanaAltura=796
VentanaAncho=1170
PanelArriba=120
PanelBotones=80
ListaLineas=Título<BR>Título<BR>Detalle
[Vista]
Icono=0
Clave=RM1006ContadoresXSucursalRep
VistaIndependiente=S
ListaCampos=linea<BR>Registros<BR>Importe<BR>contador<BR>plazo<BR>Sucursal<BR>Sucural1
ControlSucursal=S
CampoSucursal=Sucursal
BaseSR=S
SQL=declare @fechad datetime, @fechaa datetime<BR><BR>set @fechad = <T>{Fechaformatoservidor(Info.FechaD)}<T><BR>set @fechaa = <T>{Fechaformatoservidor(Info.FechaA)}<T><BR><BR>select Sucural1 =F.Sucursal, F.Sucursal, F.Linea, F.Registros, F.Importe,<BR>plazo = dbo.Fn_DM0154PlazoPromedio (<T>Sucursal<T>,<T><T>,@fechad,@fechaa,f.sucursal,<T>factura,factura viu,factura mayoreo<T>,<T>Normal<T>),<BR>F.contador<BR>from<BR>(<BR>select s.Sucursal, R.linea, Registros = Sum(R.Registros), Importe = Sum(R.Importe), contador = max(D.Contador)<BR>from sucursal s<BR>left join (<BR><TAB>Select sucursal = V.SucursalVenta, linea = (case when ar.ArtTipoGarantiaMavi = 1 then <T>GARANTIAS AMPLIADAS<T> else v.linea end), <BR><TAB>Registros = Case When M.Clave = <T>vtas.d<T> Then -1 Else 1 End,<BR><TAB>Importe = (case when V.Linea = <T>CREDILANA<T> then Sum(Cantidad * Costo) else sum(cantidad * precio - DescuentoImporte) end)<BR><TAB>From v_maviventasnetas v With(Nolock)<BR><TAB>Left Join MovTipo M With(Nolock) On M.Mov = V.Mov<BR><TAB>left join artlinea ar With(Nolock) on V.Linea = ar.Linea<TAB><BR><TAB>Where (M.Modulo = <T>vtas<T> or m.Mov = <T>Refinanciamiento<T>) and (V.linea in (<T>credilana<T>, <T>SEGUROS DE AUTOMOVILES<T>, <T>SEGUROS DE VIDA<T>) or ar.ArtTipoGarantiaMavi = 1)<BR><TAB>And DATEADD(DD,0,DATEDIFF(DD,0, v.FechaMavi)) Between @fechad And @fechaa and V.Categoria = <T>Venta<T><BR><TAB>Group By V.sucursalventa, V.linea, case when ar.ArtTipoGarantiaMavi = 1 then <T>GARANTIAS AMPLIADAS<T> else v.linea end, V.Mov, V.MovId, <BR><TAB>Case When M.Clave = <T>vtas.d<T> Then -1 Else 1 end<BR><TAB>) R on s.Sucursal = R.sucursal<BR>left join (<TAB><BR>Select SucursalOrigen, contador = Count(1)<BR><TAB><TAB><TAB>From CXC c With(Nolock)<BR><TAB><TAB><TAB>Inner Join MovTipo m With(Nolock) on c.mov = m.mov<BR><TAB><TAB><TAB>Where c.Estatus = <T>Concluido<T> And m.Clave In (<T>CXC.C<T>,<T>CXC.AA<T>) and m.Mov <> <T>Cobro Div Deudores<T>  <BR><TAB><TAB><TAB>And c.FechaEmision Between @fechad And @fechaa<BR><TAB><TAB><TAB>Group By SucursalOrigen<BR><TAB>) d on d.SucursalOrigen = s.Sucursal<BR>Group By R.linea, s.sucursal<BR>) F<BR>order by F.sucursal
[linea]
Clave=linea
Nombre=linea
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=50
TipoDatos=Texto
Tamano=50
ClaveBDE=Linea
[Linea1]
Clave=Título
Objetos=1
Seccion=Título
AltoEnCm=0.372
Renglones=1
[Linea2]
Clave=Título
Objetos=1
Seccion=Título
AltoEnCm=0.372
Renglones=1
[A1]
Celda=A1
Alineacion=Izquierda
AnchoEnCm=24.18
AnchoTexto=130
TablaAncho=(Auto)
TablaAnchoCeldas=(Auto)
TablaAnchoTituloRenglon=(Auto)
TablaAnchoTotales=(Auto)
Expresion=<T><T>+<T>De: <T>+FechaAMD(Info.FechaD)+<T> Hasta: <T>+FechaAMD(Info.FechaA)
ExpresionMultiple=S
[A2]
Celda=A2
Alineacion=Izquierda
AnchoEnCm=24.18
AnchoTexto=130
TablaAncho=(Auto)
TablaAnchoCeldas=(Auto)
TablaAnchoTituloRenglon=(Auto)
TablaAnchoTotales=(Auto)
Expresion=<T>sucursal|linea|Reg|Impte|plazo|contador<T>
[Linea3]
Clave=Detalle
Objetos=1
Seccion=Detalle
AltoEnCm=0.372
Renglones=1
[A3]
Celda=A3
Alineacion=Izquierda
AnchoEnCm=24.18
AnchoTexto=130
TablaAncho=(Auto)
TablaAnchoCeldas=(Auto)
TablaAnchoTituloRenglon=(Auto)
TablaAnchoTotales=(Auto)
Expresion=<T><T>+Sucural1+<T>|<T>+linea+<T>|<T>+Registros+<T>|<T>+Importe+<T>|<T>+plazo+<T>|<T>+contador+<T><T>
[Registros]
Clave=Registros
Nombre=Registros
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=Registros
[Importe]
Clave=Importe
Nombre=Importe
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=NumFlotante
ClaveBDE=Importe
[contador]
Clave=contador
Nombre=contador
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=contador
[plazo]
Clave=plazo
Nombre=plazo
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=NumFlotante
ClaveBDE=plazo
[Sucursal]
Clave=Sucursal
Nombre=Sucursal
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=Sucursal
[Sucural1]
Clave=Sucural1
Nombre=Sucural1
Visible=S
OpcionesColumnas=1
OpcionesRenglones=8
TamanoValidacion=10
TipoDatos=Numérico
ClaveBDE=Sucural1
