SET DATEFIRST 7
SET ANSI_NULLS OFF
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SET LOCK_TIMEOUT -1
SET QUOTED_IDENTIFIER OFF
SET NOCOUNT ON
SET IMPLICIT_TRANSACTIONS OFF
GO
ALTER FUNCTION dbo.fnTablaTipoMovimiento
(
@Tabla				varchar(50)
)
RETURNS int

AS BEGIN
DECLARE
@Tipo					int
SELECT @Tipo = 0
IF dbo.fnIDLocalTablaModulo(@Tabla) IS NOT NULL SELECT @Tipo = 1
IF @Tipo = 0 AND EXISTS(SELECT * FROM SysColumns WHERE Name LIKE '%Modulo%' AND Length = 5 AND xType IN (167,175) AND ID = OBJECT_ID(@Tabla)) AND EXISTS(SELECT * FROM SysColumns WHERE Name IN ('ID', 'ModuloID', 'OID', 'DID') AND xType = 56 AND ID = OBJECT_ID(@Tabla)) SELECT @Tipo = 2
RETURN (@Tipo)
END

