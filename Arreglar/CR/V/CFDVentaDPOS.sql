SET DATEFIRST 7
SET ANSI_NULLS OFF
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SET LOCK_TIMEOUT -1
SET QUOTED_IDENTIFIER OFF
SET NOCOUNT ON
SET IMPLICIT_TRANSACTIONS OFF
GO
ALTER VIEW CFDVentaDPOS AS
SELECT
CFDVentaD2.OrdenExportacion,
CFDVentaD2.VentaCliente,
CFDVentaD2.ID,
CFDVentaD2.VentaDCantidad,
(((CFDVentaD2.VentaDCantidad-CFDVentaD2.VentaDCantidadObsequio)*CFDVentaD2.VentaDCantidadInventario)/CFDVentaD2.VentaDCantidad)  VentaDCantidadInventario,
CFDVentaD2.VentaDUnidad,
CFDVentaD2.UnidadClave,
CFDVentaD2.VentaDArticulo,
CFDVentaD2.EAN13,
CFDVentaD2.SKUCliente,
CFDVentaD2.SKUEmpresa,
CFDVentaD2.DUN14,
CFDVentaD2.VentaDDescripcion,
CFDVentaD2.VentaDDescripcion2,
CFDVentaD2.ArtTipoEmpaque,
CFDVentaD2.VentaDPrecio,
CFDVentaD2.VentaDPrecioTotal,
CFDVentaD2.VentaDDescuentoLinea,
CFDVentaD2.VentaDDescuentoImporte,
CFDVentaD2.ventaDImpuesto1,
CFDVentaD2.ventaDImpuesto2,
CFDVentaD2.VentaDImporte,
CFDVentaD2.VentaDImporteUnitario,
CFDVentaD2.VentaDDescLineal,
CFDVentaD2.VentaDDescuentosTotales,
CFDVentaD2.VentaDImporteSobrePrecio,
CFDVentaD2.VentaDSubTotal,
CFDVentaD2.VentaDSubTotalUnitario,
CFDVentaD2.VentaDImpuesto1Total,
CFDVentaD2.VentaDImpuesto2Total,
CFDVentaD2.VentaDImpuestos,
CFDVentaD2.VentaDImporteTotal,
CFDVentaD2.VentaDTotalNeto,
CFDVentaD2.TipoEmpaqueClave,
CFDVentaD2.TipoEmpaqueTipo,
CFDVentaD2.VentaDRenglon,
CFDVentaD2.VentaDRenglonSub,
CFDVentaD2.VentaDRenglonID,
CFDVentaD2.VentaDRenglonTipo,
CFDVentaD2.VentaDAlmacen,
CFDVentaD2.VentaDEnviarA,
CFDVentaD2.VentaDCodigo,
CFDVentaD2.VentaDSubCuenta,
CFDVentaD2.VentaDPrecioSugerido,
CFDVentaD2.VentaDDescuentoTipo,
CFDVentaD2.VentaDImpuesto3,
CFDVentaD2.VentaDDescripcionExtra,
CFDVentaD2.VentaDCosto,
CFDVentaD2.VentaDCostoActividad,
CFDVentaD2.VentaDPaquete,
CFDVentaD2.VentaDContUso,
CFDVentaD2.VentaDComision,
CFDVentaD2.VentaDAplica,
CFDVentaD2.VentaDAplicaID,
CFDVentaD2.VentaDCantidadPendiente,
CFDVentaD2.VentaDCantidadReservada,
CFDVentaD2.VentaDCantidadCancelada,
CFDVentaD2.VentaDCantidadOrdenada,
CFDVentaD2.VentaDCantidadEmbarcada,
CFDVentaD2.VentaDCantidadA,
CFDVentaD2.VentaDFactor,
CFDVentaD2.VentaDSustitutoArticulo,
CFDVentaD2.VentaDSustitutoSubCuenta,
CFDVentaD2.VentaDFechaRequerida,
CFDVentaD2.VentaDHoraRequerida,
CFDVentaD2.VentaDInstruccion,
CFDVentaD2.VentaDAgente,
CFDVentaD2.VentaDDepartamento,
CFDVentaD2.VentaDUltimoReservadoCantidad,
CFDVentaD2.VentaDUltimoReservadoFecha,
CFDVentaD2.VentaDSucursal,
CFDVentaD2.VentaDPoliticaPrecios,
CFDVentaD2.VentaDSucursalOrigen,
CFDVentaD2.VentaDAutoLocalidad,
CFDVentaD2.VentaDUEN,
CFDVentaD2.VentaDEspacio,
CFDVentaD2.VentaDCantidadAlterna,
CFDVentaD2.VentaDPrecioMoneda,
CFDVentaD2.VentaDPrecioTipoCambio,
CFDVentaD2.VentaDEstado,
CFDVentaD2.VentaDServicioNumero,
CFDVentaD2.VentaDAgentesAsignados,
CFDVentaD2.VentaDAFArticulo,
CFDVentaD2.VentaDExcluirPlaneacion,
CFDVentaD2.VentaDAnexo,
CFDVentaD2.VentaDAjusteCosteo,
CFDVentaD2.VentaDCostoUEPS,
CFDVentaD2.VentaDCostoPEPS,
CFDVentaD2.VentaDUltimoCosto,
CFDVentaD2.VentaDPrecioLista,
CFDVentaD2.VentaDDepartamentoDetallista,
CFDVentaD2.VentaDPresupuestoEsp,
CFDVentaD2.VentaDPosicion,
CFDVentaD2.VentaDPuntos,
CFDVentaD2.VentaDCantidadObsequio,
CFDVentaD2.VentaDOfertaID,
CFDVentaD2.VentaDProveedorRef,
CFDVentaD2.VentaDTransferirA,
CFDVentaD2.VentaDArtEstatus,
CFDVentaD2.VentaDArtSituacion,
CFDVentaD2.VentaDTarima,
CFDVentaD2.VentaDExcluirISAN,
CFDVentaD2.VentaDContUso2,
CFDVentaD2.VentaDContUso3,
CFDVentaD2.VentaDCostoEstandar,
CFDVentaD2.VentaDABC,
CFDVentaD2.VentaDOrdenCompra,
CFDVentaD2.VentaDTipoImpuesto1,
CFDVentaD2.VentaDTipoImpuesto2,
CFDVentaD2.VentaDTipoImpuesto3,
CFDVentaD2.VentaDCostoPromedio,
CFDVentaD2.VentaDCostoReposicion,
CFDVentaD2.VentaDTipoComprobante,
CFDVentaD2.VentaDSustentoComprobante,
CFDVentaD2.VentaDTipoIdentificacion,
CFDVentaD2.VentaDDerechoDevolucion,
CFDVentaD2.VentaDEstablecimiento,
CFDVentaD2.VentaDPuntoEmision,
CFDVentaD2.VentaDSecuencialSRI,
CFDVentaD2.VentaDAutorizacionSRI,
CFDVentaD2.VentaDVigenteA,
CFDVentaD2.VentaDSecuenciaRetencion,
CFDVentaD2.VentaDComprobante,
CFDVentaD2.VentaDFechaContableMov,
CFDVentaD2.VentaDTipoRetencion1,
CFDVentaD2.VentaDTipoRetencion2,
CFDVentaD2.VentaDTipoRetencion3,
CFDVentaD2.VentaDRetencion1,
CFDVentaD2.VentaDRetencion2,
CFDVentaD2.VentaDRetencion3
FROM CFDVentaD2
WHERE CFDVentaD2.VentaDCantidad <> 0
UNION ALL
SELECT
REPLICATE('0',20-LEN(RTRIM(LTRIM(CONVERT(varchar,CFDVentaD2.ID))))) + RTRIM(LTRIM(CONVERT(varchar,CFDVentaD2.ID))) +
REPLICATE('0',12-LEN(RTRIM(LTRIM(CONVERT(varchar,CFDVentaD2.VentaDRenglon+1.0))))) + RTRIM(LTRIM(CONVERT(varchar,CFDVentaD2.VentaDRenglon+1))) +
REPLICATE('0',7-LEN(RTRIM(LTRIM(CONVERT(varchar,CFDVentaD2.VentaDRenglonSub))))) + RTRIM(LTRIM(CONVERT(varchar,CFDVentaD2.VentaDRenglonSub))) +
REPLICATE(' ',50)
OrdenExportacion,
CFDVentaD2.VentaCliente,
CFDVentaD2.ID,
CFDVentaD2.VentaDCantidadObsequio VentaDCantidad,
(((CFDVentaD2.VentaDCantidadObsequio)*CFDVentaD2.VentaDCantidadInventario)/CFDVentaD2.VentaDCantidad)  VentaDCantidadInventario,
CFDVentaD2.VentaDUnidad,
CFDVentaD2.UnidadClave,
CFDVentaD2.VentaDArticulo ,
CFDVentaD2.EAN13,
CFDVentaD2.SKUCliente,
CFDVentaD2.SKUEmpresa,
CFDVentaD2.DUN14,
CFDVentaD2.VentaDDescripcion,
CFDVentaD2.VentaDDescripcion2,
CFDVentaD2.ArtTipoEmpaque,
0.0 As VentaDPrecio,
0.0 As VentaDPrecioTotal,
0.0 As VentaDDescuentoLinea,
0.0 As VentaDDescuentoImporte,
0.0 As ventaDImpuesto1,
0.0 As ventaDImpuesto2,
0.0 As VentaDImporte,
0.0 As VentaDImporteUnitario,
0.0 As VentaDDescLineal,
0.0 As VentaDDescuentosTotales,
0.0 As VentaDImporteSobrePrecio,
0.0 As VentaDSubTotal,
0.0 As VentaDSubTotalUnitario,
0.0 As VentaDImpuesto1Total,
0.0 As VentaDImpuesto2Total,
0.0 As VentaDImpuestos,
0.0 As VentaDImporteTotal,
0.0 As VentaDTotalNeto,
CFDVentaD2.TipoEmpaqueClave,
CFDVentaD2.TipoEmpaqueTipo,
(CFDVentaD2.VentaDRenglon+1) As VentaDRenglon,
(CFDVentaD2.VentaDRenglonSub)VentaDRenglonSub,
(CFDVentaD2.VentaDRenglonID)VentaDRenglonID,
CFDVentaD2.VentaDRenglonTipo,
CFDVentaD2.VentaDAlmacen,
CFDVentaD2.VentaDEnviarA,
CFDVentaD2.VentaDCodigo,
CFDVentaD2.VentaDSubCuenta,
CFDVentaD2.VentaDPrecioSugerido,
CFDVentaD2.VentaDDescuentoTipo,
0.0 As VentaDImpuesto3,
CFDVentaD2.VentaDDescripcionExtra,
CFDVentaD2.VentaDCosto,
CFDVentaD2.VentaDCostoActividad,
CFDVentaD2.VentaDPaquete,
CFDVentaD2.VentaDContUso,
CFDVentaD2.VentaDComision,
CFDVentaD2.VentaDAplica,
CFDVentaD2.VentaDAplicaID,
CFDVentaD2.VentaDCantidadPendiente,
CFDVentaD2.VentaDCantidadReservada,
CFDVentaD2.VentaDCantidadCancelada,
CFDVentaD2.VentaDCantidadOrdenada,
CFDVentaD2.VentaDCantidadEmbarcada,
CFDVentaD2.VentaDCantidadA,
CFDVentaD2.VentaDFactor,
CFDVentaD2.VentaDSustitutoArticulo,
CFDVentaD2.VentaDSustitutoSubCuenta,
CFDVentaD2.VentaDFechaRequerida,
CFDVentaD2.VentaDHoraRequerida,
CFDVentaD2.VentaDInstruccion,
CFDVentaD2.VentaDAgente,
CFDVentaD2.VentaDDepartamento,
CFDVentaD2.VentaDUltimoReservadoCantidad,
CFDVentaD2.VentaDUltimoReservadoFecha,
CFDVentaD2.VentaDSucursal,
CFDVentaD2.VentaDPoliticaPrecios,
CFDVentaD2.VentaDSucursalOrigen,
CFDVentaD2.VentaDAutoLocalidad,
CFDVentaD2.VentaDUEN,
CFDVentaD2.VentaDEspacio,
CFDVentaD2.VentaDCantidadAlterna,
CFDVentaD2.VentaDPrecioMoneda,
CFDVentaD2.VentaDPrecioTipoCambio,
CFDVentaD2.VentaDEstado,
CFDVentaD2.VentaDServicioNumero,
CFDVentaD2.VentaDAgentesAsignados,
CFDVentaD2.VentaDAFArticulo,
CFDVentaD2.VentaDExcluirPlaneacion,
CFDVentaD2.VentaDAnexo,
CFDVentaD2.VentaDAjusteCosteo,
CFDVentaD2.VentaDCostoUEPS,
CFDVentaD2.VentaDCostoPEPS,
CFDVentaD2.VentaDUltimoCosto,
CFDVentaD2.VentaDPrecioLista,
CFDVentaD2.VentaDDepartamentoDetallista,
CFDVentaD2.VentaDPresupuestoEsp,
CFDVentaD2.VentaDPosicion,
CFDVentaD2.VentaDPuntos,
CFDVentaD2.VentaDCantidadObsequio,
CFDVentaD2.VentaDOfertaID,
CFDVentaD2.VentaDProveedorRef,
CFDVentaD2.VentaDTransferirA,
CFDVentaD2.VentaDArtEstatus,
CFDVentaD2.VentaDArtSituacion,
CFDVentaD2.VentaDTarima,
CFDVentaD2.VentaDExcluirISAN,
CFDVentaD2.VentaDContUso2,
CFDVentaD2.VentaDContUso3,
CFDVentaD2.VentaDCostoEstandar,
CFDVentaD2.VentaDABC,
CFDVentaD2.VentaDOrdenCompra,
CFDVentaD2.VentaDTipoImpuesto1,
CFDVentaD2.VentaDTipoImpuesto2,
CFDVentaD2.VentaDTipoImpuesto3,
CFDVentaD2.VentaDCostoPromedio,
CFDVentaD2.VentaDCostoReposicion,
CFDVentaD2.VentaDTipoComprobante,
CFDVentaD2.VentaDSustentoComprobante,
CFDVentaD2.VentaDTipoIdentificacion,
CFDVentaD2.VentaDDerechoDevolucion,
CFDVentaD2.VentaDEstablecimiento,
CFDVentaD2.VentaDPuntoEmision,
CFDVentaD2.VentaDSecuencialSRI,
CFDVentaD2.VentaDAutorizacionSRI,
CFDVentaD2.VentaDVigenteA,
CFDVentaD2.VentaDSecuenciaRetencion,
CFDVentaD2.VentaDComprobante,
CFDVentaD2.VentaDFechaContableMov,
CFDVentaD2.VentaDTipoRetencion1,
CFDVentaD2.VentaDTipoRetencion2,
CFDVentaD2.VentaDTipoRetencion3,
0.0 As VentaDRetencion1,
0.0 As VentaDRetencion2,
0.0 As VentaDRetencion3
FROM CFDVentaD2
WHERE CFDVentaD2.VentaDCantidadObsequio <> 0

