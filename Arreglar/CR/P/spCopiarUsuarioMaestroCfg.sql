SET DATEFIRST 7
SET ANSI_NULLS OFF
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SET LOCK_TIMEOUT -1
SET QUOTED_IDENTIFIER OFF
SET NOCOUNT ON
SET IMPLICIT_TRANSACTIONS OFF
GO
ALTER PROCEDURE spCopiarUsuarioMaestroCfg
@UsuarioD    char(10)

AS BEGIN
DECLARE
@UsuarioA	char(10)
IF NULLIF(@UsuarioD,'') IS NULL RETURN
BEGIN TRANSACTION
DECLARE crUsuarioCfg CURSOR FOR
SELECT Usuario FROM Usuario WHERE Configuracion = @UsuarioD
OPEN crUsuarioCfg
FETCH NEXT FROM crUsuarioCfg INTO @UsuarioA
WHILE @@FETCH_STATUS <> -1
BEGIN
IF @@FETCH_STATUS <> -2
EXEC spCopiarUsuarioCfg @UsuarioD, @UsuarioA
FETCH NEXT FROM crUsuarioCfg INTO @UsuarioA
END  
CLOSE crUsuarioCfg
DEALLOCATE crUsuarioCfg
COMMIT TRANSACTION
RETURN
END

