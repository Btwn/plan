SET DATEFIRST 7
SET ANSI_NULLS OFF
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SET LOCK_TIMEOUT -1
SET QUOTED_IDENTIFIER OFF
SET NOCOUNT ON
SET IMPLICIT_TRANSACTIONS OFF
GO
ALTER PROCEDURE spCuentaInsertarArt
@ID                        int,
@iSolicitud                           int,
@Version                              float,
@Resultado                         varchar(max) = NULL OUTPUT,
@Ok                                                      int = NULL OUTPUT,
@OkRef                                 varchar(255) = NULL OUTPUT

AS BEGIN
DECLARE
@Articulo                                                   varchar(20),
@Rama                                       varchar(20),
@Descripcion1                                         varchar(100),
@Descripcion2                                         varchar(255),
@NombreCorto                                        varchar(20),
@Grupo                                      varchar(50),
@Categoria                               varchar(50),
@CategoriaActivoFijo             varchar(50),
@Familia                                                   varchar(50),
@Linea                                       varchar(50),
@Fabricante                                             varchar(50),
@ClaveFabricante                                  varchar(50),
@Impuesto1                              float   ,
@Impuesto2                              float   ,
@Impuesto3                              float   ,
@Factor                                                     varchar(50),
@Unidad                                                   varchar(50),
@UnidadCompra                                    varchar(50),
@UnidadTraspaso                                  varchar(50),
@UnidadCantidad                                 float   ,
@TipoCosteo                                            varchar(10),
@Peso                                         float   ,
@Tara                                         float   ,
@Volumen                                 float   ,
@Tipo                                         varchar(20),
@TipoOpcion                                           varchar(20),
@Accesorios                                              bit   ,
@Refacciones                                           bit   ,
@Sustitutos                                               bit   ,
@Servicios                                 bit   ,
@Consumibles                                         bit   ,
@MonedaCosto                                       varchar(10),
@MonedaPrecio                                      varchar(10),
@MargenMinimo                                    money   ,
@PrecioLista                                             money   ,
@PrecioMinimo                                       money   ,
@FactorAlterno                                        float   ,
@PrecioAnterior                       money   ,
@Utilidad                                   varchar(50),
@DescuentoCompra                              float   ,
@Clase                                        varchar(15),
@Estatus                                                    varchar(15),
@UltimoCambio                                      datetime   ,
@Alta                                          datetime   ,
@Conciliar                                 bit   ,
@Mensaje                                  varchar(50),
@Comision                                varchar(50),
@Arancel                                                   varchar(50),
@ArancelDesperdicio             varchar(50),
@ABC                                          varchar(1),
@Usuario                                                   varchar(10),
@Precio2                                                   money   ,
@Precio3                                                   money   ,
@Precio4                                                   money   ,
@Precio5                                                   money   ,
@Precio6                                                   money   ,
@Precio7                                                   money   ,
@Precio8                                                   money   ,
@Precio9                                                   money   ,
@Precio10                                  money   ,
@Refrigeracion                                        bit   ,
@TieneCaducidad                                  bit   ,
@BasculaPesar                                         bit   ,
@SeProduce                              bit   ,
@Situacion                                varchar(50),
@SituacionFecha                    datetime   ,
@SituacionUsuario                                  varchar(10),
@SituacionNota                                       varchar(100),
@EstatusPrecio                                         varchar(15),
@wMostrar                                bit   ,
@Merma                                    float   ,
@Desperdicio                                           float   ,
@SeCompra                              bit   ,
@SeVende                                bit   ,
@EsFormula                              bit   ,
@TiempoEntrega                                    int   ,
@TiempoEntregaUnidad      varchar(10),
@TiempoEntregaSeg                            int   ,
@TiempoEntregaSegUnidad   varchar(10),
@LoteOrdenar                                         varchar(30),
@CantidadOrdenar                                float   ,
@MultiplosOrdenar                                float   ,
@InvSeguridad                                       float   ,
@ProdRuta                                 varchar(20),
@AlmacenROP                                         varchar(10),
@CategoriaProd                                      varchar(50),
@ProdCantidad                                       float   ,
@ProdUsuario                                          varchar(10),
@ProdPasoTotal                                      int   ,
@ProdMovGrupo                                    varchar(50),
@ProdEstacion                                         varchar(10),
@ProdOpciones                                       bit   ,
@ProdVerConcentracion       bit   ,
@ProdVerCostoAcumulado                  bit   ,
@ProdVerMerma                                     bit   ,
@ProdVerDesperdicio            bit   ,
@ProdVerPorcentaje                              bit   ,
@RevisionUltima                     datetime   ,
@RevisionUsuario                    varchar(10),
@RevisionFrecuencia             int   ,
@RevisionFrecuenciaUnidad  varchar(10),
@RevisionSiguiente                               datetime   ,
@ProdMov                                 varchar(20),
@TipoCompra                                          varchar(20),
@TieneMovimientos                              bit   ,
@Registro1                                varchar(20),
@Registro1Vencimiento        datetime   ,
@AlmacenEspecificoVenta   varchar(10),
@AlmacenEspecificoVentaMov varchar(20),
@RutaDistribucion                                  varchar(50),
@CostoEstandar                                      float   ,
@CostoReposicion                                  float   ,
@EstatusCosto                                          varchar(15),
@Margen                                   money  ,
@Proveedor                              varchar(10),
@NivelAcceso                                          varchar(50),
@Temporada                            varchar(50),
@SolicitarPrecios                      bit   ,
@AutoRecaudacion                                varchar(30),
@Concepto                               varchar(50),
@Cuenta                                                   varchar(20),
@Retencion1                                            float   ,
@Retencion2                                            float   ,
@Retencion3                                            float   ,
@Espacios                                  bit   ,
@EspaciosEspecificos             bit   ,
@EspaciosSobreventa           float   ,
@EspaciosNivel                                       varchar(50),
@EspaciosMinutos                                  int   ,
@EspaciosBloquearAnteriores  bit   ,
@EspaciosHoraD                                     varchar(5),
@EspaciosHoraA                                     varchar(5),
@SerieLoteInfo                                        bit   ,
@CantidadMinimaVenta      float   ,
@CantidadMaximaVenta     float   ,
@EstimuloFiscal                       float   ,
@OrigenPais                                             varchar(50),
@OrigenLocalidad                                  varchar(50),
@Incentivo                                money   ,
@FactorCompra                                      float   ,
@Horas                                       float   ,
@ISAN                                         bit   ,
@ExcluirDescFormaPago       bit   ,
@EsDeducible                                          bit   ,
@Peaje                                       money   ,
@CodigoAlterno                                      varchar(50),
@TipoCatalogo                                        varchar(20),
@AnexosAlFacturar                                bit   ,
@CaducidadMinima                              int   ,
@Actividades                                           bit   ,
@ValidarPresupuestoCompra  varchar(20),
@SeriesLotesAutoOrden        varchar(20),
@LotesFijos                                               bit   ,
@LotesAuto                               bit   ,
@Consecutivo                                          int   ,
@TipoEmpaque                                      varchar(50),
@Modelo                                                   varchar(4),
@TieneDireccion                     bit   ,
@Direccion                                varchar(100),
@DireccionNumero                                varchar(20),
@DireccionNumeroInt                           varchar(10),
@EntreCalles                                            varchar(100),
@Plano                                       varchar(15),
@Observaciones                                     varchar(100),
@Colonia                                                   varchar(100),
@Delegacion                                           varchar(100),
@Poblacion                               varchar(100),
@Estado                                                    varchar(30),
@Pais                                          varchar(30),
@CodigoPostal                                        varchar(15),
@Ruta                                         varchar(50),
@Codigo                                                   varchar(50),
@ClaveVehicular                     varchar(20),
@TipoVehiculo                                        varchar(20),
@DiasLibresintereses                             int   ,
@PrecioLiberado                     bit   ,
@ValidarCodigo                                      bit   ,
@Presentacion                                         varchar(50),
@GarantiaPlazo                                       int   ,
@CostoIdentificado                                bit   ,
@CantidadTarima                                  float   ,
@UnidadTarima                                      varchar(50),
@MinimoTarima                                      float   ,
@DepartamentoDetallista   int   ,
@TratadoComercial                                varchar(50),
@CuentaPresupuesto                             varchar(20),
@ProgramaSectorial                               varchar(50),
@PedimentoClave                                  varchar(5),
@PedimentoRegimen                           varchar(5),
@Permiso                                                      varchar(20),
@PermisoRenglon                                  varchar(20),
@Cuenta2                                                     varchar(20),
@Cuenta3                                                     varchar(20),
@Impuesto1Excento                              bit   ,
@CalcularPresupuesto            bit   ,
@InflacionPresupuesto          float   ,
@Excento2                                                    bit   ,
@Excento3                                                    bit,
@ContUso                                                     varchar(20),
@ContUso2                                                   varchar(20),
@ContUso3                                                   varchar(20),
@NivelToleranciaCosto          varchar(10),
@ToleranciaCosto                   money   ,
@ToleranciaCostoInferior  money   ,
@ObjetoGasto                                          varchar(10),
@ObjetoGastoRef                    varchar(10),
@ClavePresupuestalImpuesto1  varchar(50),
@Estructura                                               varchar(50),
@TipoImpuesto1                                     varchar(10),
@TipoImpuesto2                                     varchar(10),
@TipoImpuesto3                                     varchar(10),
@TipoRetencion1                    varchar(10),
@TipoRetencion2                    varchar(10),
@TipoRetencion3                    varchar(10),
@TipoImpuesto4                                     varchar(10),
@Calificacion                            smallint   ,
@TipoImpuesto5                                     varchar(10),
@INFORStockMinimo                             float   ,
@INFORStockMaximo                            float   ,
@InforPrefijo                                             varchar(20),
@InforSufijo                                              varchar(20),
@CodigoEstructura                                 varchar(20),
@TipoVariante                                         varchar(5),
@InforTipo                                                    varchar(50),
@IDGenerar                                                      int,
@MovTipo                                         varchar(20),
@ReferenciaIS                                                  varchar(100) ,
@SubReferencia                                              varchar(100)
DECLARE @Temp   table(
Articulo                                                      varchar(20),
Rama                                          varchar(20),
Descripcion1                                            varchar(100),
Descripcion2                                            varchar(255),
NombreCorto                                           varchar(20),
Grupo                                         varchar(50),
Categoria                                   varchar(50),
CategoriaActivoFijo                varchar(50),
Familia                        varchar(50),
Linea                                           varchar(50),
Fabricante                                 varchar(50),
ClaveFabricante                      varchar(50),
Impuesto1                                 float   ,
Impuesto2                                 float   ,
Impuesto3                                 float   ,
Factor                                         varchar(50),
Unidad                                       varchar(50),
UnidadCompra                                       varchar(50),
UnidadTraspaso                                     varchar(50),
UnidadCantidad                                    float   ,
TipoCosteo                                varchar(10),
Peso                                            float   ,
Tara                                             float   ,
Volumen                                                   float   ,
Tipo                                             varchar(20),
TipoOpcion                               varchar(20),
Accesorios                                  bit   ,
Refacciones                                              bit   ,
Sustitutos                                                   bit   ,
Servicios                                                    bit   ,
Consumibles                                            bit   ,
MonedaCosto                                          varchar(10),
MonedaPrecio                                         varchar(10),
MargenMinimo                                       money   ,
PrecioLista                                                 money   ,
PrecioMinimo                                           money   ,
FactorAlterno                                           float   ,
PrecioAnterior                                          money   ,
Utilidad                                                     varchar(50),
DescuentoCompra                                 float   ,
Clase                                           varchar(15),
Estatus                        varchar(15),
UltimoCambio                                         datetime   ,
Alta                                              datetime   ,
Conciliar                                                    bit   ,
Mensaje                                                    varchar(50),
Comision                                                   varchar(50),
Arancel                                                      varchar(50),
ArancelDesperdicio                                varchar(50),
ABC                                             varchar(1),
Usuario                                                      varchar(10),
Precio2                        money   ,
Precio3                        money   ,
Precio4                        money   ,
Precio5                        money   ,
Precio6                        money   ,
Precio7                        money   ,
Precio8                        money   ,
Precio9                        money   ,
Precio10                                                    money   ,
Refrigeracion                                           bit   ,
TieneCaducidad                                     bit   ,
BasculaPesar                                            bit   ,
SeProduce                                 bit   ,
Situacion                                                   varchar(50),
SituacionFecha                                       datetime   ,
SituacionUsuario                     varchar(10),
SituacionNota                                          varchar(100),
EstatusPrecio                                            varchar(15),
wMostrar                                                   bit   ,
Merma                                        float   ,
Desperdicio                                              float   ,
SeCompra                                  bit   ,
SeVende                                                   bit   ,
EsFormula                                  bit   ,
TiempoEntrega                                       int   ,
TiempoEntregaUnidad         varchar(10),
TiempoEntregaSeg                                int   ,
TiempoEntregaSegUnidad                 varchar(10),
LoteOrdenar                                             varchar(30),
CantidadOrdenar                   float   ,
MultiplosOrdenar                    float   ,
InvSeguridad                                           float   ,
ProdRuta                                                   varchar(20),
AlmacenROP                             varchar(10),
CategoriaProd                                         varchar(50),
ProdCantidad                                          float   ,
ProdUsuario                                              varchar(10),
ProdPasoTotal                                          int   ,
ProdMovGrupo                                        varchar(50),
ProdEstacion                                            varchar(10),
ProdOpciones                                          bit   ,
ProdVerConcentracion          bit   ,
ProdVerCostoAcumulado      bit   ,
ProdVerMerma                                        bit   ,
ProdVerDesperdicio                               bit   ,
ProdVerPorcentaje                                 bit   ,
RevisionUltima                                        datetime   ,
RevisionUsuario                       varchar(10),
RevisionFrecuencia                                int   ,
RevisionFrecuenciaUnidad  varchar(10),
RevisionSiguiente                                   datetime   ,
ProdMov                                                   varchar(20),
TipoCompra                              varchar(20),
TieneMovimientos                                 bit   ,
Registro1                                                   varchar(20),
Registro1Vencimiento           datetime   ,
AlmacenEspecificoVenta      varchar(10),
AlmacenEspecificoVentaMov varchar(20),
RutaDistribucion                      varchar(50),
CostoEstandar                                         float   ,
CostoReposicion                      float   ,
EstatusCosto                                             varchar(15),
Margen                                      money  ,
Proveedor                                  varchar(10),
NivelAcceso                                              varchar(50),
Temporada                               varchar(50),
SolicitarPrecios                         bit   ,
AutoRecaudacion                    varchar(30),
Concepto                                   varchar(50),
Cuenta                                       varchar(20),
Retencion1                                float   ,
Retencion2                                float   ,
Retencion3                                float   ,
Espacios                                                    bit   ,
EspaciosEspecificos                bit   ,
EspaciosSobreventa                              float   ,
EspaciosNivel                                           varchar(50),
EspaciosMinutos                      int   ,
EspaciosBloquearAnteriores  bit   ,
EspaciosHoraD                                        varchar(5),
EspaciosHoraA                                         varchar(5),
SerieLoteInfo                                            bit   ,
CantidadMinimaVenta         float   ,
CantidadMaximaVenta         float   ,
EstimuloFiscal                                          float   ,
OrigenPais                                 varchar(50),
OrigenLocalidad                     varchar(50),
Incentivo                                                   money   ,
FactorCompra                                          float   ,
Horas                                          float   ,
ISAN                                            bit   ,
ExcluirDescFormaPago          bit   ,
EsDeducible                                             bit   ,
Peaje                                           money   ,
CodigoAlterno                                         varchar(50),
TipoCatalogo                                           varchar(20),
AnexosAlFacturar                    bit   ,
CaducidadMinima                                 int   ,
Actividades                                              bit   ,
ValidarPresupuestoCompra  varchar(20),
SeriesLotesAutoOrden           varchar(20),
LotesFijos                                   bit   ,
LotesAuto                                   bit   ,
Consecutivo                                             int   ,
TipoEmpaque                                          varchar(50),
Modelo                                       varchar(4),
TieneDireccion                                        bit   ,
Direccion                                                   varchar(100),
DireccionNumero                    varchar(20),
DireccionNumeroInt                               varchar(20),
EntreCalles                                               varchar(100),
Plano                                          varchar(15),
Observaciones                                         varchar(100),
Colonia                                                      varchar(100),
Delegacion                               varchar(100),
Poblacion                                  varchar(100),
Estado                                        varchar(30),
Pais                                              varchar(30),
CodigoPostal                                            varchar(15),
Ruta                                             varchar(50),
Codigo                                       varchar(50),
ClaveVehicular                                        varchar(20),
TipoVehiculo                                            varchar(20),
DiasLibresintereses                 int   ,
PrecioLiberado                                        bit   ,
ValidarCodigo                                         bit   ,
Presentacion                                            varchar(50),
GarantiaPlazo                                          int   ,
CostoIdentificado                    bit   ,
CantidadTarima                                      float   ,
UnidadTarima                                         varchar(50),
MinimoTarima                                         float   ,
DepartamentoDetallista        int   ,
TratadoComercial                   varchar(50),
CuentaPresupuesto                                varchar(20),
ProgramaSectorial                                  varchar(50),
PedimentoClave                                     varchar(5),
PedimentoRegimen                               varchar(5),
Permiso                                          varchar(20),
PermisoRenglon                                      varchar(20),
Cuenta2                                         varchar(20),
Cuenta3                                         varchar(20),
Impuesto1Excento                                  bit   ,
CalcularPresupuesto               bit   ,
InflacionPresupuesto              float   ,
Excento2                                       bit   ,
Excento3                                       bit,
ContUso                                         varchar(20),
ContUso2                                                      varchar(20),
ContUso3                                                      varchar(20),
NivelToleranciaCosto             varchar(10),
ToleranciaCosto                       money   ,
ToleranciaCostoInferior   money   ,
ObjetoGasto                                             varchar(10),
ObjetoGastoRef                                       varchar(10),
ClavePresupuestalImpuesto1  varchar(50),
Estructura                                   varchar(50),
TipoImpuesto1                                        varchar(10),
TipoImpuesto2                                        varchar(10),
TipoImpuesto3                                        varchar(10),
TipoRetencion1                                       varchar(10),
TipoRetencion2                                       varchar(10),
TipoRetencion3                                       varchar(10),
TipoImpuesto4                                        varchar(10),
Calificacion                               smallint   ,
TipoImpuesto5                                        varchar(10),
INFORStockMinimo                                float   ,
INFORStockMaximo                                float   ,
INFORPrefijo                                             varchar(20),
INFORSufijo                                              varchar(20),
INFORTipo                                                    varchar(50),
CodigoEstructura                                    varchar(20),
TipoVariante                                            varchar(5)
)
BEGIN TRANSACTION
INSERT @Temp ( Articulo,  Rama,  Descripcion1,  Descripcion2,  NombreCorto,  Grupo,  Categoria,  CategoriaActivoFijo,  Familia,  Linea,  Fabricante,  ClaveFabricante,  Impuesto1,  Impuesto2,  Impuesto3,  Factor,  Unidad,  UnidadCompra,  UnidadTraspaso,  UnidadCantidad,  TipoCosteo,  Peso,  Tara,  Volumen,  Tipo,  TipoOpcion,  Accesorios,  Refacciones,  Sustitutos,  Servicios,  Consumibles,  MonedaCosto,  MonedaPrecio,  MargenMinimo,  PrecioLista,  PrecioMinimo,  FactorAlterno,  PrecioAnterior,  Utilidad,  DescuentoCompra,  Clase,  Estatus,  UltimoCambio,  Alta,  Conciliar,  Mensaje,  Comision,  Arancel,  ArancelDesperdicio,  ABC,  Usuario,  Precio2,  Precio3,  Precio4,  Precio5,  Precio6,  Precio7,  Precio8,  Precio9,  Precio10,  Refrigeracion,  TieneCaducidad,  BasculaPesar,  SeProduce,  Situacion,  SituacionFecha,  SituacionUsuario,  SituacionNota,  EstatusPrecio,  wMostrar,  Merma,  Desperdicio,  SeCompra,  SeVende,  EsFormula,  TiempoEntrega,  TiempoEntregaUnidad,  TiempoEntregaSeg,  TiempoEntregaSegUnidad,  LoteOrdenar,  CantidadOrdenar,  MultiplosOrdenar,  InvSeguridad,  ProdRuta,  AlmacenROP,  CategoriaProd,  ProdCantidad,  ProdUsuario,  ProdPasoTotal,  ProdMovGrupo,  ProdEstacion,  ProdOpciones,  ProdVerConcentracion,  ProdVerCostoAcumulado,  ProdVerMerma,  ProdVerDesperdicio,  ProdVerPorcentaje,  RevisionUltima,  RevisionUsuario,  RevisionFrecuencia,  RevisionFrecuenciaUnidad,  RevisionSiguiente,  ProdMov,  TipoCompra,  TieneMovimientos,  Registro1,  Registro1Vencimiento,  AlmacenEspecificoVenta,  AlmacenEspecificoVentaMov,  RutaDistribucion,  CostoEstandar,  CostoReposicion,  EstatusCosto,  Margen,  Proveedor,  NivelAcceso,  Temporada,  SolicitarPrecios,  AutoRecaudacion,  Concepto,  Cuenta,  Retencion1,  Retencion2,  Retencion3,  Espacios,  EspaciosEspecificos,  EspaciosSobreventa,  EspaciosNivel,  EspaciosMinutos,  EspaciosBloquearAnteriores,  EspaciosHoraD,  EspaciosHoraA,  SerieLoteInfo,  CantidadMinimaVenta,  CantidadMaximaVenta,  EstimuloFiscal,  OrigenPais,  OrigenLocalidad,  Incentivo,  FactorCompra,  Horas,  ISAN,  ExcluirDescFormaPago,  EsDeducible,  Peaje,  CodigoAlterno,  TipoCatalogo,  AnexosAlFacturar,  CaducidadMinima,  Actividades,  ValidarPresupuestoCompra,  SeriesLotesAutoOrden,  LotesFijos,  LotesAuto,  Consecutivo,  TipoEmpaque,  Modelo,TieneDireccion,  Direccion,  DireccionNumero,  DireccionNumeroInt,  EntreCalles,  Plano,  Observaciones,  Colonia,  Delegacion,  Poblacion,  Estado,  Pais,  CodigoPostal,  Ruta,  Codigo,  ClaveVehicular,  TipoVehiculo,  DiasLibresIntereses,  PrecioLiberado,  ValidarCodigo,  Presentacion,  GarantiaPlazo,  CostoIdentificado,  CantidadTarima,  UnidadTarima,  MinimoTarima,  DepartamentoDetallista,  TratadoComercial,  CuentaPresupuesto,  ProgramaSectorial,  PedimentoClave,  PedimentoRegimen,  Permiso,  PermisoRenglon,  Cuenta2,  Cuenta3,  Impuesto1Excento,  CalcularPresupuesto,  InflacionPresupuesto,  Excento2,  Excento3,  ContUso,  ContUso2,  ContUso3,  NivelToleranciaCosto,  ToleranciaCosto,  ToleranciaCostoInferior,  ObjetoGasto,  ObjetoGastoRef,  ClavePresupuestalImpuesto1,  Estructura,  TipoImpuesto1,  TipoImpuesto2,  TipoImpuesto3,  TipoRetencion1,  TipoRetencion2,  TipoRetencion3,  TipoImpuesto4,  Calificacion,  TipoImpuesto5,  INFORStockMinimo,  INFORStockMaximo,  INFORPrefijo,  INFORSufijo, INFORTipo, CodigoEstructura     ,TipoVariante )
SELECT         Articulo,  Rama,  Descripcion1,  Descripcion2,  NombreCorto,  Grupo,  Categoria,  CategoriaActivoFijo,  Familia,  Linea,  Fabricante,  ClaveFabricante,  Impuesto1,  Impuesto2,  Impuesto3,  Factor,  Unidad,  UnidadCompra,  UnidadTraspaso,  UnidadCantidad,  TipoCosteo,  Peso,  Tara,  Volumen,  Tipo,  TipoOpcion,  Accesorios,  Refacciones,  Sustitutos,  Servicios,  Consumibles,  MonedaCosto,  MonedaPrecio,  MargenMinimo,  PrecioLista,  PrecioMinimo,  FactorAlterno,  PrecioAnterior,  Utilidad,  DescuentoCompra,  Clase,  Estatus,  UltimoCambio,  Alta,  Conciliar,  Mensaje,  Comision,  Arancel,  ArancelDesperdicio,  ABC,  Usuario,  Precio2,  Precio3,  Precio4,  Precio5,  Precio6,  Precio7,  Precio8,  Precio9,  Precio10,  Refrigeracion,  TieneCaducidad,  BasculaPesar,  SeProduce,  Situacion,  SituacionFecha,  SituacionUsuario,  SituacionNota,  EstatusPrecio,  wMostrar,  Merma,  Desperdicio,  SeCompra,  SeVende,  EsFormula,  TiempoEntrega,  TiempoEntregaUnidad,  TiempoEntregaSeg,  TiempoEntregaSegUnidad,  LoteOrdenar,  CantidadOrdenar,  MultiplosOrdenar,  InvSeguridad,  ProdRuta,  AlmacenROP,  CategoriaProd,  ProdCantidad,  ProdUsuario,  ProdPasoTotal,  ProdMovGrupo,  ProdEstacion,  ProdOpciones,  ProdVerConcentracion,  ProdVerCostoAcumulado,  ProdVerMerma,  ProdVerDesperdicio,  ProdVerPorcentaje,  RevisionUltima,  RevisionUsuario,  RevisionFrecuencia,  RevisionFrecuenciaUnidad,  RevisionSiguiente,  ProdMov,  TipoCompra,  TieneMovimientos,  Registro1,  Registro1Vencimiento,  AlmacenEspecificoVenta,  AlmacenEspecificoVentaMov,  RutaDistribucion,  CostoEstandar,  CostoReposicion,  EstatusCosto,  Margen,  Proveedor,  NivelAcceso,  Temporada,  SolicitarPrecios,  AutoRecaudacion,  Concepto,  Cuenta,  Retencion1,  Retencion2,  Retencion3,  Espacios,  EspaciosEspecificos,  EspaciosSobreventa,  EspaciosNivel,  EspaciosMinutos,  EspaciosBloquearAnteriores,  EspaciosHoraD,  EspaciosHoraA,  SerieLoteInfo,  CantidadMinimaVenta,  CantidadMaximaVenta,  EstimuloFiscal,  OrigenPais,  OrigenLocalidad,  Incentivo,  FactorCompra,  Horas,  ISAN,  ExcluirDescFormaPago,  EsDeducible,  Peaje,  CodigoAlterno,  TipoCatalogo,  AnexosAlFacturar,  CaducidadMinima,  Actividades,  ValidarPresupuestoCompra,  SeriesLotesAutoOrden,  LotesFijos,  LotesAuto,  Consecutivo,  TipoEmpaque,  Modelo,TieneDireccion,  Direccion,  DireccionNumero,  DireccionNumeroInt,  EntreCalles,  Plano,  Observaciones,  Colonia,  Delegacion,  Poblacion,  Estado,  Pais,  CodigoPostal,  Ruta,  Codigo,  ClaveVehicular,  TipoVehiculo,  DiasLibresIntereses,  PrecioLiberado,  ValidarCodigo,  Presentacion,  GarantiaPlazo,  CostoIdentificado,  CantidadTarima,  UnidadTarima,  MinimoTarima,  DepartamentoDetallista,  TratadoComercial,  CuentaPresupuesto,  ProgramaSectorial,  PedimentoClave,  PedimentoRegimen,  Permiso,  PermisoRenglon,  Cuenta2,  Cuenta3,  Impuesto1Excento,  CalcularPresupuesto,  InflacionPresupuesto,  Excento2,  Excento3,  ContUso,  ContUso2,  ContUso3,  NivelToleranciaCosto,  ToleranciaCosto,  ToleranciaCostoInferior,  ObjetoGasto,  ObjetoGastoRef,  ClavePresupuestalImpuesto1,  Estructura,  TipoImpuesto1,  TipoImpuesto2,  TipoImpuesto3,  TipoRetencion1,  TipoRetencion2,  TipoRetencion3,  TipoImpuesto4,  Calificacion,  TipoImpuesto5,  INFORStockMinimo,  INFORStockMaximo,  INFORPrefijo, INFORSufijo,  CASE INFORTipo  WHEN  1 THEN 'PRODUCTO ACABADO' WHEN 2 THEN 'SEMIELABORADO' WHEN 3 THEN 'TRABAJO EXTERIOR'  WHEN 4 THEN 'MATERIA PRIMA' END, CodigoEstructura                ,TipoVariante
FROM OPENXML (@iSolicitud, '/Intelisis/Solicitud/Art',1)
WITH (Articulo varchar(100),  Rama varchar(100),  Descripcion1 varchar(100),  Descripcion2 varchar(100),  NombreCorto varchar(100),  Grupo varchar(100),  Categoria varchar(100),  CategoriaActivoFijo varchar(100),  Familia varchar(100),  Linea varchar(100),  Fabricante varchar(100),  ClaveFabricante varchar(100),  Impuesto1 varchar(100),  Impuesto2 varchar(100),  Impuesto3 varchar(100),  Factor varchar(100),  Unidad varchar(100),  UnidadCompra varchar(100),  UnidadTraspaso varchar(100),  UnidadCantidad varchar(100),  TipoCosteo varchar(100),  Peso varchar(100),  Tara varchar(100),  Volumen varchar(100),  Tipo varchar(100),  TipoOpcion varchar(100),  Accesorios varchar(100),  Refacciones varchar(100),  Sustitutos varchar(100),  Servicios varchar(100),  Consumibles varchar(100),  MonedaCosto varchar(100),  MonedaPrecio varchar(100),  MargenMinimo varchar(100),  PrecioLista varchar(100),  PrecioMinimo varchar(100),  FactorAlterno varchar(100),  PrecioAnterior varchar(100),  Utilidad varchar(100),  DescuentoCompra varchar(100),  Clase varchar(100),  Estatus varchar(100),  UltimoCambio varchar(100),  Alta varchar(100),  Conciliar varchar(100),  Mensaje varchar(100),  Comision varchar(100),  Arancel varchar(100),  ArancelDesperdicio varchar(100),  ABC varchar(100),  Usuario varchar(100),  Precio2 varchar(100),  Precio3 varchar(100),  Precio4 varchar(100),  Precio5 varchar(100),  Precio6 varchar(100),  Precio7 varchar(100),  Precio8 varchar(100),  Precio9 varchar(100),  Precio10 varchar(100),  Refrigeracion varchar(100),  TieneCaducidad varchar(100),  BasculaPesar varchar(100),  SeProduce varchar(100),  Situacion varchar(100),  SituacionFecha varchar(100),  SituacionUsuario varchar(100),  SituacionNota varchar(100),  EstatusPrecio varchar(100),  wMostrar varchar(100),  Merma varchar(100),  Desperdicio varchar(100),  SeCompra varchar(100),  SeVende varchar(100),  EsFormula varchar(100),  TiempoEntrega varchar(100),  TiempoEntregaUnidad varchar(100),  TiempoEntregaSeg varchar(100),  TiempoEntregaSegUnidad varchar(100),  LoteOrdenar varchar(100),  CantidadOrdenar varchar(100),  MultiplosOrdenar varchar(100),  InvSeguridad varchar(100),  ProdRuta varchar(100),  AlmacenROP varchar(100),  CategoriaProd varchar(100),  ProdCantidad varchar(100),  ProdUsuario varchar(100),  ProdPasoTotal varchar(100),  ProdMovGrupo varchar(100),  ProdEstacion varchar(100),  ProdOpciones varchar(100),  ProdVerConcentracion varchar(100),  ProdVerCostoAcumulado varchar(100),  ProdVerMerma varchar(100),  ProdVerDesperdicio varchar(100),  ProdVerPorcentaje varchar(100),  RevisionUltima varchar(100),  RevisionUsuario varchar(100),  RevisionFrecuencia varchar(100),  RevisionFrecuenciaUnidad varchar(100),  RevisionSiguiente varchar(100),  ProdMov varchar(100),  TipoCompra varchar(100),  TieneMovimientos varchar(100),  Registro1 varchar(100),  Registro1Vencimiento varchar(100),  AlmacenEspecificoVenta varchar(100),  AlmacenEspecificoVentaMov varchar(100),  RutaDistribucion varchar(100),  CostoEstandar varchar(100),  CostoReposicion varchar(100),  EstatusCosto varchar(100),  Margen varchar(100),  Proveedor varchar(100),  NivelAcceso varchar(100),  Temporada varchar(100),  SolicitarPrecios varchar(100),  AutoRecaudacion varchar(100),  Concepto varchar(100),  Cuenta varchar(100),  Retencion1 varchar(100),  Retencion2 varchar(100),  Retencion3 varchar(100),  Espacios varchar(100),  EspaciosEspecificos varchar(100),  EspaciosSobreventa varchar(100),  EspaciosNivel varchar(100),  EspaciosMinutos varchar(100),  EspaciosBloquearAnteriores varchar(100),  EspaciosHoraD varchar(100),  EspaciosHoraA varchar(100),  SerieLoteInfo varchar(100),  CantidadMinimaVenta varchar(100),  CantidadMaximaVenta varchar(100),  EstimuloFiscal varchar(100),  OrigenPais varchar(100),  OrigenLocalidad varchar(100),  Incentivo varchar(100),  FactorCompra varchar(100),  Horas varchar(100),  ISAN varchar(100),  ExcluirDescFormaPago varchar(100),  EsDeducible varchar(100),  Peaje varchar(100),  CodigoAlterno varchar(100),  TipoCatalogo varchar(100),  AnexosAlFacturar varchar(100),  CaducidadMinima varchar(100),  Actividades varchar(100),  ValidarPresupuestoCompra varchar(100),  SeriesLotesAutoOrden varchar(100),  LotesFijos varchar(100),  LotesAuto varchar(100),  Consecutivo varchar(100),  TipoEmpaque varchar(100),  Modelo varchar(100),  TieneDireccion varchar(100),  Direccion varchar(100),  DireccionNumero varchar(100),  DireccionNumeroInt varchar(100),  EntreCalles varchar(100),  Plano varchar(100),  Observaciones varchar(100),  Colonia varchar(100),  Delegacion varchar(100),  Poblacion varchar(100),  Estado varchar(100),  Pais varchar(100),  CodigoPostal varchar(100),  Ruta varchar(100),  Codigo varchar(100),  ClaveVehicular varchar(100),  TipoVehiculo varchar(100),  DiasLibresIntereses varchar(100),  PrecioLiberado varchar(100),  ValidarCodigo varchar(100),  Presentacion varchar(100),  GarantiaPlazo varchar(100),  CostoIdentificado varchar(100),  CantidadTarima varchar(100),  UnidadTarima varchar(100),  MinimoTarima varchar(100),  DepartamentoDetallista varchar(100),  TratadoComercial varchar(100),  CuentaPresupuesto varchar(100),  ProgramaSectorial varchar(100),  PedimentoClave varchar(100),  PedimentoRegimen varchar(100),  Permiso varchar(100),  PermisoRenglon varchar(100),  Cuenta2 varchar(100),  Cuenta3 varchar(100),  Impuesto1Excento varchar(100),  CalcularPresupuesto varchar(100),  InflacionPresupuesto varchar(100),  Excento2 varchar(100),  Excento3 varchar(100),  ContUso varchar(100),  ContUso2 varchar(100),  ContUso3 varchar(100),  NivelToleranciaCosto varchar(100),  ToleranciaCosto varchar(100),  ToleranciaCostoInferior varchar(100),  ObjetoGasto varchar(100),  ObjetoGastoRef varchar(100),  ClavePresupuestalImpuesto1 varchar(100),  Estructura varchar(100),  TipoImpuesto1 varchar(100),  TipoImpuesto2 varchar(100),  TipoImpuesto3 varchar(100),  TipoRetencion1 varchar(100),  TipoRetencion2 varchar(100),  TipoRetencion3 varchar(100),  TipoImpuesto4 varchar(100),  Calificacion varchar(100),  TipoImpuesto5 varchar(100),  INFORStockMinimo varchar(100),  INFORStockMaximo varchar(100),  InforPrefijo varchar(100),  InforSufijo varchar(100),  InforTipo varchar(100) ,CodigoEstructura varchar(100), TipoVariante varchar(100))
DECLARE crDetalle CURSOR LOCAL FAST_FORWARD FOR
SELECT Articulo,  Rama,  Descripcion1,  Descripcion2,  NombreCorto,  Grupo,  Categoria,  CategoriaActivoFijo,  Familia,  Linea,  Fabricante,  ClaveFabricante,  Impuesto1,  Impuesto2,  Impuesto3,  Factor,  Unidad,  UnidadCompra,  UnidadTraspaso,  UnidadCantidad,  TipoCosteo,  Peso,  Tara,  Volumen,  Tipo,  TipoOpcion,  Accesorios,  Refacciones,  Sustitutos,  Servicios,  Consumibles,  MonedaCosto,  MonedaPrecio,  MargenMinimo,  PrecioLista,  PrecioMinimo,  FactorAlterno,  PrecioAnterior,  Utilidad,  DescuentoCompra,  Clase,  Estatus,  UltimoCambio,  Alta,  Conciliar,  Mensaje,  Comision,  Arancel,  ArancelDesperdicio,  ABC,  Usuario,  Precio2,  Precio3,  Precio4,  Precio5,  Precio6,  Precio7,  Precio8,  Precio9,  Precio10,  Refrigeracion,  TieneCaducidad,  BasculaPesar,  SeProduce,  Situacion,  SituacionFecha,  SituacionUsuario,  SituacionNota,  EstatusPrecio,  wMostrar,  Merma,  Desperdicio,  SeCompra,  SeVende,  EsFormula,  TiempoEntrega,  TiempoEntregaUnidad,  TiempoEntregaSeg,  TiempoEntregaSegUnidad,  LoteOrdenar,  CantidadOrdenar,  MultiplosOrdenar,  InvSeguridad,  ProdRuta,  AlmacenROP,  CategoriaProd,  ProdCantidad,  ProdUsuario,  ProdPasoTotal,  ProdMovGrupo,  ProdEstacion,  ProdOpciones,  ProdVerConcentracion,  ProdVerCostoAcumulado,  ProdVerMerma,  ProdVerDesperdicio,  ProdVerPorcentaje,  RevisionUltima,  RevisionUsuario,  RevisionFrecuencia,  RevisionFrecuenciaUnidad,  RevisionSiguiente,  ProdMov,  TipoCompra,  TieneMovimientos,  Registro1,  Registro1Vencimiento,  AlmacenEspecificoVenta,  AlmacenEspecificoVentaMov,  RutaDistribucion,  CostoEstandar,  CostoReposicion,  EstatusCosto,  Margen,  Proveedor,  NivelAcceso,  Temporada,  SolicitarPrecios,  AutoRecaudacion,  Concepto,  Cuenta,  Retencion1,  Retencion2,  Retencion3,  Espacios,  EspaciosEspecificos,  EspaciosSobreventa,  EspaciosNivel,  EspaciosMinutos,  EspaciosBloquearAnteriores,  EspaciosHoraD,  EspaciosHoraA,  SerieLoteInfo,  CantidadMinimaVenta,  CantidadMaximaVenta,  EstimuloFiscal,  OrigenPais,  OrigenLocalidad,  Incentivo,  FactorCompra,  Horas,  ISAN,  ExcluirDescFormaPago,  EsDeducible,  Peaje,  CodigoAlterno,  TipoCatalogo,  AnexosAlFacturar,  CaducidadMinima,  Actividades,  ValidarPresupuestoCompra,  SeriesLotesAutoOrden,  LotesFijos,  LotesAuto,  Consecutivo,  TipoEmpaque,  Modelo,  TieneDireccion,  Direccion,  DireccionNumero,  DireccionNumeroInt,  EntreCalles,  Plano,  Observaciones,  Colonia,  Delegacion,  Poblacion,  Estado,  Pais,  CodigoPostal,  Ruta,  Codigo,  ClaveVehicular,  TipoVehiculo,  DiasLibresIntereses,  PrecioLiberado,  ValidarCodigo,  Presentacion,  GarantiaPlazo,  CostoIdentificado,  CantidadTarima,  UnidadTarima,  MinimoTarima,  DepartamentoDetallista,  TratadoComercial,  CuentaPresupuesto,  ProgramaSectorial,  PedimentoClave,  PedimentoRegimen,  Permiso,  PermisoRenglon,  Cuenta2,  Cuenta3,  Impuesto1Excento,  CalcularPresupuesto,  InflacionPresupuesto,  Excento2,  Excento3,  ContUso,  ContUso2,  ContUso3,  NivelToleranciaCosto,  ToleranciaCosto,  ToleranciaCostoInferior,  ObjetoGasto,  ObjetoGastoRef,  ClavePresupuestalImpuesto1,  Estructura,  TipoImpuesto1,  TipoImpuesto2,  TipoImpuesto3,  TipoRetencion1,  TipoRetencion2,  TipoRetencion3,  TipoImpuesto4,  Calificacion,  TipoImpuesto5,  INFORStockMinimo,  INFORStockMaximo,  InforPrefijo,  InforSufijo,  InforTipo, CodigoEstructura             ,TipoVariante
FROM @Temp
OPEN crDetalle
FETCH NEXT FROM crDetalle INTO @Articulo, @Rama, @Descripcion1, @Descripcion2, @NombreCorto, @Grupo, @Categoria, @CategoriaActivoFijo, @Familia, @Linea, @Fabricante, @ClaveFabricante, @Impuesto1, @Impuesto2, @Impuesto3, @Factor, @Unidad, @UnidadCompra, @UnidadTraspaso, @UnidadCantidad, @TipoCosteo, @Peso, @Tara, @Volumen, @Tipo, @TipoOpcion, @Accesorios, @Refacciones, @Sustitutos, @Servicios, @Consumibles, @MonedaCosto, @MonedaPrecio, @MargenMinimo, @PrecioLista, @PrecioMinimo, @FactorAlterno, @PrecioAnterior, @Utilidad, @DescuentoCompra, @Clase, @Estatus, @UltimoCambio, @Alta, @Conciliar, @Mensaje, @Comision, @Arancel, @ArancelDesperdicio, @ABC, @Usuario, @Precio2, @Precio3, @Precio4, @Precio5, @Precio6, @Precio7, @Precio8, @Precio9, @Precio10, @Refrigeracion, @TieneCaducidad, @BasculaPesar, @SeProduce, @Situacion, @SituacionFecha, @SituacionUsuario, @SituacionNota, @EstatusPrecio, @wMostrar, @Merma, @Desperdicio, @SeCompra, @SeVende, @EsFormula, @TiempoEntrega, @TiempoEntregaUnidad, @TiempoEntregaSeg, @TiempoEntregaSegUnidad, @LoteOrdenar, @CantidadOrdenar, @MultiplosOrdenar, @InvSeguridad, @ProdRuta, @AlmacenROP, @CategoriaProd, @ProdCantidad, @ProdUsuario, @ProdPasoTotal, @ProdMovGrupo, @ProdEstacion, @ProdOpciones, @ProdVerConcentracion, @ProdVerCostoAcumulado, @ProdVerMerma, @ProdVerDesperdicio, @ProdVerPorcentaje, @RevisionUltima, @RevisionUsuario, @RevisionFrecuencia, @RevisionFrecuenciaUnidad, @RevisionSiguiente, @ProdMov, @TipoCompra, @TieneMovimientos, @Registro1, @Registro1Vencimiento, @AlmacenEspecificoVenta, @AlmacenEspecificoVentaMov, @RutaDistribucion, @CostoEstandar, @CostoReposicion, @EstatusCosto, @Margen, @Proveedor, @NivelAcceso, @Temporada, @SolicitarPrecios, @AutoRecaudacion, @Concepto, @Cuenta, @Retencion1, @Retencion2, @Retencion3, @Espacios, @EspaciosEspecificos, @EspaciosSobreventa, @EspaciosNivel, @EspaciosMinutos, @EspaciosBloquearAnteriores, @EspaciosHoraD, @EspaciosHoraA, @SerieLoteInfo, @CantidadMinimaVenta, @CantidadMaximaVenta, @EstimuloFiscal, @OrigenPais, @OrigenLocalidad, @Incentivo, @FactorCompra, @Horas, @ISAN, @ExcluirDescFormaPago, @EsDeducible, @Peaje, @CodigoAlterno, @TipoCatalogo, @AnexosAlFacturar, @CaducidadMinima, @Actividades, @ValidarPresupuestoCompra, @SeriesLotesAutoOrden, @LotesFijos, @LotesAuto, @Consecutivo, @TipoEmpaque, @Modelo, @TieneDireccion, @Direccion, @DireccionNumero, @DireccionNumeroInt, @EntreCalles, @Plano, @Observaciones, @Colonia, @Delegacion, @Poblacion, @Estado, @Pais, @CodigoPostal, @Ruta, @Codigo, @ClaveVehicular, @TipoVehiculo, @DiasLibresIntereses, @PrecioLiberado, @ValidarCodigo, @Presentacion, @GarantiaPlazo, @CostoIdentificado, @CantidadTarima, @UnidadTarima, @MinimoTarima, @DepartamentoDetallista, @TratadoComercial, @CuentaPresupuesto, @ProgramaSectorial, @PedimentoClave, @PedimentoRegimen, @Permiso, @PermisoRenglon, @Cuenta2, @Cuenta3, @Impuesto1Excento, @CalcularPresupuesto, @InflacionPresupuesto, @Excento2, @Excento3, @ContUso, @ContUso2, @ContUso3, @NivelToleranciaCosto, @ToleranciaCosto, @ToleranciaCostoInferior, @ObjetoGasto, @ObjetoGastoRef, @ClavePresupuestalImpuesto1, @Estructura, @TipoImpuesto1, @TipoImpuesto2, @TipoImpuesto3, @TipoRetencion1, @TipoRetencion2, @TipoRetencion3, @TipoImpuesto4, @Calificacion, @TipoImpuesto5, @INFORStockMinimo, @INFORStockMaximo, @InforPrefijo, @InforSufijo, @InforTipo, @CodigoEstructura  ,@TipoVariante
WHILE @@FETCH_STATUS = 0 AND @Ok IS NULL
BEGIN
IF NOT EXISTS(SELECT * FROM Art WHERE Grupo = @Grupo) AND NULLIF(@Grupo,'') IS NOT NULL SELECT @Ok = 10255
IF NOT EXISTS(SELECT * FROM Art WHERE Familia = @Familia ) AND NULLIF(@Familia,'') IS NOT NULL SELECT @Ok = 10265
IF NOT EXISTS(SELECT * FROM Art WHERE AlmacenROP = @AlmacenROP ) SELECT @Ok = 20830
IF EXISTS(SELECT * FROM Art WHERE Articulo = @Articulo) SELECT @Ok = 1
IF @Tipo NOT IN ('Normal','Servicio','Serie','Lote','Juego','Estructura') SELECT @Ok = 73030
INSERT Art( Articulo,  Rama,  Descripcion1,  Descripcion2,  NombreCorto,  Grupo,  Categoria,  CategoriaActivoFijo,  Familia,  Linea,  Fabricante,  ClaveFabricante,  Impuesto1,  Impuesto2,  Impuesto3,  Factor,  Unidad,  UnidadCompra,  UnidadTraspaso,  UnidadCantidad,  TipoCosteo,  Peso,  Tara,  Volumen,  Tipo,  TipoOpcion,  Accesorios,  Refacciones,  Sustitutos,  Servicios,  Consumibles,  MonedaCosto,  MonedaPrecio,  MargenMinimo,  PrecioLista,  PrecioMinimo,  FactorAlterno,  PrecioAnterior,  Utilidad,  DescuentoCompra,  Clase,  Estatus,  UltimoCambio,  Alta,  Conciliar,  Mensaje,  Comision,  Arancel,  ArancelDesperdicio,  ABC,  Usuario,  Precio2,  Precio3,  Precio4,  Precio5,  Precio6,  Precio7,  Precio8,  Precio9,  Precio10,  Refrigeracion,  TieneCaducidad,  BasculaPesar,  SeProduce,  Situacion,  SituacionFecha,  SituacionUsuario,  SituacionNota,  EstatusPrecio,  wMostrar,  Merma,  Desperdicio,  SeCompra,  SeVende,  EsFormula,  TiempoEntrega,  TiempoEntregaUnidad,  TiempoEntregaSeg,  TiempoEntregaSegUnidad,  LoteOrdenar,  CantidadOrdenar,  MultiplosOrdenar,  InvSeguridad,  ProdRuta,  AlmacenROP,  CategoriaProd,  ProdCantidad,  ProdUsuario,  ProdPasoTotal,  ProdMovGrupo,  ProdEstacion,  ProdOpciones,  ProdVerConcentracion,  ProdVerCostoAcumulado,  ProdVerMerma,  ProdVerDesperdicio,  ProdVerPorcentaje,  RevisionUltima,  RevisionUsuario,  RevisionFrecuencia,  RevisionFrecuenciaUnidad,  RevisionSiguiente,  ProdMov,  TipoCompra,  TieneMovimientos,  Registro1,  Registro1Vencimiento,  AlmacenEspecificoVenta,  AlmacenEspecificoVentaMov,  RutaDistribucion,  CostoEstandar,  CostoReposicion,  EstatusCosto,  Margen,  Proveedor,  NivelAcceso,  Temporada,  SolicitarPrecios,  AutoRecaudacion,  Concepto,  Cuenta,  Retencion1,  Retencion2,  Retencion3,  Espacios,  EspaciosEspecificos,  EspaciosSobreventa,  EspaciosNivel,  EspaciosMinutos,  EspaciosBloquearAnteriores,  EspaciosHoraD,  EspaciosHoraA,  SerieLoteInfo,  CantidadMinimaVenta,  CantidadMaximaVenta,  EstimuloFiscal,  OrigenPais,  OrigenLocalidad,  Incentivo,  FactorCompra,  Horas,  ISAN,  ExcluirDescFormaPago,  EsDeducible,  Peaje,  CodigoAlterno,  TipoCatalogo,  AnexosAlFacturar,  CaducidadMinima,  Actividades,  ValidarPresupuestoCompra,  SeriesLotesAutoOrden,  LotesFijos,  LotesAuto,  Consecutivo,  TipoEmpaque,  Modelo,  TieneDireccion,  Direccion,  DireccionNumero,  DireccionNumeroInt,  EntreCalles,  Plano,  Observaciones,  Colonia,  Delegacion,  Poblacion,  Estado,  Pais,  CodigoPostal,  Ruta,  Codigo,  ClaveVehicular,  TipoVehiculo,  DiasLibresIntereses,  PrecioLiberado,  ValidarCodigo,  Presentacion,  GarantiaPlazo,  CostoIdentificado,  CantidadTarima,  UnidadTarima,  MinimoTarima,  DepartamentoDetallista,  TratadoComercial,  CuentaPresupuesto,  ProgramaSectorial,  PedimentoClave,  PedimentoRegimen,  Permiso,  PermisoRenglon,  Cuenta2,  Cuenta3,  Impuesto1Excento,  CalcularPresupuesto,  InflacionPresupuesto,  Excento2,  Excento3,  ContUso,  ContUso2,  ContUso3,  NivelToleranciaCosto,  ToleranciaCosto,  ToleranciaCostoInferior,  ObjetoGasto,  ObjetoGastoRef,  ClavePresupuestalImpuesto1,  Estructura,  TipoImpuesto1,  TipoImpuesto2,  TipoImpuesto3,  TipoRetencion1,  TipoRetencion2,  TipoRetencion3,  TipoImpuesto4,  Calificacion,  TipoImpuesto5,  INFORStockMinimo,  INFORStockMaximo,  INFORPrefijo,  INFORSufijo,  INFORTipo, CodigoEstructura    ,TipoVariante)
VALUES    (@Articulo, @Rama, @Descripcion1, @Descripcion2, @NombreCorto, @Grupo, @Categoria, @CategoriaActivoFijo, @Familia, @Linea, @Fabricante, @ClaveFabricante, @Impuesto1, @Impuesto2, @Impuesto3, @Factor, @Unidad, @UnidadCompra, @UnidadTraspaso, @UnidadCantidad, @TipoCosteo, @Peso, @Tara, @Volumen, @Tipo, @TipoOpcion, @Accesorios, @Refacciones, @Sustitutos, @Servicios, @Consumibles, @MonedaCosto, @MonedaPrecio, @MargenMinimo, @PrecioLista, @PrecioMinimo, @FactorAlterno, @PrecioAnterior, @Utilidad, @DescuentoCompra, @Clase, @Estatus, @UltimoCambio, @Alta, @Conciliar, @Mensaje, @Comision, @Arancel, @ArancelDesperdicio, @ABC, @Usuario, @Precio2, @Precio3, @Precio4, @Precio5, @Precio6, @Precio7, @Precio8, @Precio9, @Precio10, @Refrigeracion, @TieneCaducidad, @BasculaPesar, @SeProduce, @Situacion, @SituacionFecha, @SituacionUsuario, @SituacionNota, @EstatusPrecio, @wMostrar, @Merma, @Desperdicio, @SeCompra, @SeVende, @EsFormula, @TiempoEntrega, @TiempoEntregaUnidad, @TiempoEntregaSeg, @TiempoEntregaSegUnidad, @LoteOrdenar, @CantidadOrdenar, @MultiplosOrdenar, @InvSeguridad, @ProdRuta, @AlmacenROP, @CategoriaProd, @ProdCantidad, @ProdUsuario, @ProdPasoTotal, @ProdMovGrupo, @ProdEstacion, @ProdOpciones, @ProdVerConcentracion, @ProdVerCostoAcumulado, @ProdVerMerma, @ProdVerDesperdicio, @ProdVerPorcentaje, @RevisionUltima, @RevisionUsuario, @RevisionFrecuencia, @RevisionFrecuenciaUnidad, @RevisionSiguiente, @ProdMov, @TipoCompra, @TieneMovimientos, @Registro1, @Registro1Vencimiento, @AlmacenEspecificoVenta, @AlmacenEspecificoVentaMov, @RutaDistribucion, @CostoEstandar, @CostoReposicion, @EstatusCosto, @Margen, @Proveedor, @NivelAcceso, @Temporada, @SolicitarPrecios, @AutoRecaudacion, @Concepto, @Cuenta, @Retencion1, @Retencion2, @Retencion3, @Espacios, @EspaciosEspecificos, @EspaciosSobreventa, @EspaciosNivel, @EspaciosMinutos, @EspaciosBloquearAnteriores, @EspaciosHoraD, @EspaciosHoraA, @SerieLoteInfo, @CantidadMinimaVenta, @CantidadMaximaVenta, @EstimuloFiscal, @OrigenPais, @OrigenLocalidad, @Incentivo, @FactorCompra, @Horas, @ISAN, @ExcluirDescFormaPago, @EsDeducible, @Peaje, @CodigoAlterno, @TipoCatalogo, @AnexosAlFacturar, @CaducidadMinima, @Actividades, @ValidarPresupuestoCompra, @SeriesLotesAutoOrden, @LotesFijos, @LotesAuto, @Consecutivo, @TipoEmpaque, @Modelo,  @TieneDireccion, @Direccion, @DireccionNumero, @DireccionNumeroInt, @EntreCalles, @Plano, @Observaciones, @Colonia, @Delegacion, @Poblacion, @Estado, @Pais, @CodigoPostal, @Ruta, @Codigo, @ClaveVehicular, @TipoVehiculo, @DiasLibresIntereses, @PrecioLiberado, @ValidarCodigo, @Presentacion, @GarantiaPlazo, @CostoIdentificado, @CantidadTarima, @UnidadTarima, @MinimoTarima, @DepartamentoDetallista, @TratadoComercial, @CuentaPresupuesto, @ProgramaSectorial, @PedimentoClave, @PedimentoRegimen, @Permiso, @PermisoRenglon, @Cuenta2, @Cuenta3, @Impuesto1Excento, @CalcularPresupuesto, @InflacionPresupuesto, @Excento2, @Excento3, @ContUso, @ContUso2, @ContUso3, @NivelToleranciaCosto, @ToleranciaCosto, @ToleranciaCostoInferior, @ObjetoGasto, @ObjetoGastoRef, @ClavePresupuestalImpuesto1, @Estructura, @TipoImpuesto1, @TipoImpuesto2, @TipoImpuesto3, @TipoRetencion1, @TipoRetencion2, @TipoRetencion3, @TipoImpuesto4, @Calificacion, @TipoImpuesto5, @INFORStockMinimo, @INFORStockMaximo, @InforPrefijo, @InforSufijo, @InforTipo, @CodigoEstructura            ,@TipoVariante)
IF @@ERROR <> 0 SET @Ok = 1
FETCH NEXT FROM crDetalle INTO  @Articulo, @Rama, @Descripcion1, @Descripcion2, @NombreCorto, @Grupo, @Categoria, @CategoriaActivoFijo, @Familia, @Linea, @Fabricante, @ClaveFabricante, @Impuesto1, @Impuesto2, @Impuesto3, @Factor, @Unidad, @UnidadCompra, @UnidadTraspaso, @UnidadCantidad, @TipoCosteo, @Peso, @Tara, @Volumen, @Tipo, @TipoOpcion, @Accesorios, @Refacciones, @Sustitutos, @Servicios, @Consumibles, @MonedaCosto, @MonedaPrecio, @MargenMinimo, @PrecioLista, @PrecioMinimo, @FactorAlterno, @PrecioAnterior, @Utilidad, @DescuentoCompra, @Clase, @Estatus, @UltimoCambio, @Alta, @Conciliar, @Mensaje, @Comision, @Arancel, @ArancelDesperdicio, @ABC, @Usuario, @Precio2, @Precio3, @Precio4, @Precio5, @Precio6, @Precio7, @Precio8, @Precio9, @Precio10, @Refrigeracion, @TieneCaducidad, @BasculaPesar, @SeProduce, @Situacion, @SituacionFecha, @SituacionUsuario, @SituacionNota, @EstatusPrecio, @wMostrar, @Merma, @Desperdicio, @SeCompra, @SeVende, @EsFormula, @TiempoEntrega, @TiempoEntregaUnidad, @TiempoEntregaSeg, @TiempoEntregaSegUnidad, @LoteOrdenar, @CantidadOrdenar, @MultiplosOrdenar, @InvSeguridad, @ProdRuta, @AlmacenROP, @CategoriaProd, @ProdCantidad, @ProdUsuario, @ProdPasoTotal, @ProdMovGrupo, @ProdEstacion, @ProdOpciones, @ProdVerConcentracion, @ProdVerCostoAcumulado, @ProdVerMerma, @ProdVerDesperdicio, @ProdVerPorcentaje, @RevisionUltima, @RevisionUsuario, @RevisionFrecuencia, @RevisionFrecuenciaUnidad, @RevisionSiguiente, @ProdMov, @TipoCompra, @TieneMovimientos, @Registro1, @Registro1Vencimiento, @AlmacenEspecificoVenta, @AlmacenEspecificoVentaMov, @RutaDistribucion, @CostoEstandar, @CostoReposicion, @EstatusCosto, @Margen, @Proveedor, @NivelAcceso, @Temporada, @SolicitarPrecios, @AutoRecaudacion, @Concepto, @Cuenta, @Retencion1, @Retencion2, @Retencion3, @Espacios, @EspaciosEspecificos, @EspaciosSobreventa, @EspaciosNivel, @EspaciosMinutos, @EspaciosBloquearAnteriores, @EspaciosHoraD, @EspaciosHoraA, @SerieLoteInfo, @CantidadMinimaVenta, @CantidadMaximaVenta, @EstimuloFiscal, @OrigenPais, @OrigenLocalidad, @Incentivo, @FactorCompra, @Horas, @ISAN, @ExcluirDescFormaPago, @EsDeducible, @Peaje, @CodigoAlterno, @TipoCatalogo, @AnexosAlFacturar, @CaducidadMinima, @Actividades, @ValidarPresupuestoCompra, @SeriesLotesAutoOrden, @LotesFijos, @LotesAuto, @Consecutivo, @TipoEmpaque, @Modelo, @TieneDireccion, @Direccion, @DireccionNumero, @DireccionNumeroInt, @EntreCalles, @Plano, @Observaciones, @Colonia, @Delegacion, @Poblacion, @Estado, @Pais, @CodigoPostal, @Ruta, @Codigo, @ClaveVehicular, @TipoVehiculo, @DiasLibresIntereses, @PrecioLiberado, @ValidarCodigo, @Presentacion, @GarantiaPlazo, @CostoIdentificado, @CantidadTarima, @UnidadTarima, @MinimoTarima, @DepartamentoDetallista, @TratadoComercial, @CuentaPresupuesto, @ProgramaSectorial, @PedimentoClave, @PedimentoRegimen, @Permiso, @PermisoRenglon, @Cuenta2, @Cuenta3, @Impuesto1Excento, @CalcularPresupuesto, @InflacionPresupuesto, @Excento2, @Excento3, @ContUso, @ContUso2, @ContUso3, @NivelToleranciaCosto, @ToleranciaCosto, @ToleranciaCostoInferior, @ObjetoGasto, @ObjetoGastoRef, @ClavePresupuestalImpuesto1, @Estructura, @TipoImpuesto1, @TipoImpuesto2, @TipoImpuesto3, @TipoRetencion1, @TipoRetencion2, @TipoRetencion3, @TipoImpuesto4, @Calificacion, @TipoImpuesto5, @INFORStockMinimo, @INFORStockMaximo, @InforPrefijo, @InforSufijo, @InforTipo, @CodigoEstructura  ,@TipoVariante
END
CLOSE crDetalle
DEALLOCATE crDetalle
IF @Ok IS NULL
SELECT @ReferenciaIS = Referencia
FROM IntelisisService
WHERE ID = @ID
SET @Resultado = '<?xml version="1.0" encoding="windows-1252"?><Intelisis Sistema="Intelisis" Contenido="Resultado" Referencia=' + CHAR(34) + ISNULL(@ReferenciaIS,'') + CHAR(34) + ' SubReferencia=' + CHAR(34) + ISNULL(@SubReferencia,'') + CHAR(34) + ' Version=' + CHAR(34) + ISNULL(CONVERT(varchar ,@Version),'') + CHAR(34) + '><Resultado IntelisisServiceID=' + CHAR(34) + ISNULL(CONVERT(varchar,@ID),'')  + CHAR(34) + ISNULL(CONVERT(varchar,@IDGenerar),'') + CHAR(34) + ' Ok=' + CHAR(34) + ISNULL(CONVERT(varchar,@Ok),'') + CHAR(34) + ' OkRef=' + CHAR(34) + ISNULL(@OkRef,'') + CHAR(34) + '/></Intelisis>'
IF @Ok IS NULL
BEGIN
COMMIT TRANSACTION
END ELSE
BEGIN
ROLLBACK TRANSACTION
END
END

