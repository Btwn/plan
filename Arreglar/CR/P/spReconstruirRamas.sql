SET DATEFIRST 7
SET ANSI_NULLS OFF
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SET LOCK_TIMEOUT -1
SET QUOTED_IDENTIFIER OFF
SET NOCOUNT ON
SET IMPLICIT_TRANSACTIONS OFF
GO
ALTER PROCEDURE spReconstruirRamas

AS BEGIN
SET NOCOUNT ON
DECLARE
@Rama char(5)
DECLARE crRama CURSOR FOR
SELECT Rama
FROM Rama
WHERE Rama NOT IN ('CONT', 'CC')
OPEN crRama
FETCH NEXT FROM crRama INTO @Rama
WHILE @@FETCH_STATUS <> -1
BEGIN
IF @@FETCH_STATUS <> -2
BEGIN
EXEC spReconstruirRama @Rama
END
FETCH NEXT FROM crRama INTO @Rama
END
CLOSE crRama
DEALLOCATE crRama
RETURN
END

