SET DATEFIRST 7
SET ANSI_NULLS OFF
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SET LOCK_TIMEOUT -1
SET QUOTED_IDENTIFIER OFF
SET NOCOUNT ON
SET IMPLICIT_TRANSACTIONS OFF
GO
ALTER PROCEDURE spNetComunicadosFecha
@ID 				INT,
@Estatus			INT,
@FechaComunicado    VARCHAR(50)

AS
BEGIN
BEGIN TRAN
BEGIN TRY
SELECT * FROM vwPNETComunicados where ID = @ID AND Estatus = @Estatus
AND CAST(CONVERT(CHAR(16), FechaPublicadoDate, 113) AS DATETIME)  <= @FechaComunicado
AND CAST(CONVERT(CHAR(16), FechaVigenciaDate, 113) AS DATETIME) >= @FechaComunicado
COMMIT TRAN
END TRY
BEGIN CATCH
SELECT -1 Ok, ERROR_MESSAGE() OkRef
ROLLBACK TRAN
END CATCH
END

